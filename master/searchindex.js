Search.setIndex({"docnames": ["checkpointing", "distributed", "examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.EarlyStopping", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SlowRankDetector", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "overview", "utils/generated/torchtnt.utils.data.AbstractRandomDataset", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.device.copy_data_to_device", "utils/generated/torchtnt.utils.device.get_device_from_env", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats", "utils/generated/torchtnt.utils.device.record_data_in_stream", "utils/generated/torchtnt.utils.device.set_float32_precision", "utils/generated/torchtnt.utils.distributed.PGWrapper", "utils/generated/torchtnt.utils.distributed.all_gather_tensors", "utils/generated/torchtnt.utils.distributed.barrier", "utils/generated/torchtnt.utils.distributed.destroy_process_group", "utils/generated/torchtnt.utils.distributed.get_file_init_method", "utils/generated/torchtnt.utils.distributed.get_global_rank", "utils/generated/torchtnt.utils.distributed.get_local_rank", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method", "utils/generated/torchtnt.utils.distributed.get_world_size", "utils/generated/torchtnt.utils.distributed.rank_zero_fn", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm", "utils/generated/torchtnt.utils.distributed.spawn_multi_process", "utils/generated/torchtnt.utils.distributed.sync_bool", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker", "utils/generated/torchtnt.utils.env.init_from_env", "utils/generated/torchtnt.utils.env.seed", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode", "utils/generated/torchtnt.utils.fsspec.get_filesystem", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.FileLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.MetricLogger", "utils/generated/torchtnt.utils.loggers.StdoutLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/generated/torchtnt.utils.memory.RSSProfiler", "utils/generated/torchtnt.utils.memory.measure_rss_deltas", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "utils/generated/torchtnt.utils.misc.days_to_secs", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats", "utils/generated/torchtnt.utils.module_summary.ModuleSummary", "utils/generated/torchtnt.utils.module_summary.get_module_summary", "utils/generated/torchtnt.utils.module_summary.get_summary_table", "utils/generated/torchtnt.utils.module_summary.prune_module_summary", "utils/generated/torchtnt.utils.oom.attach_oom_observer", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error", "utils/generated/torchtnt.utils.oom.log_memory_snapshot", "utils/generated/torchtnt.utils.optimizer.init_optim_state", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp", "utils/generated/torchtnt.utils.prepare_module.prepare_module", "utils/generated/torchtnt.utils.progress.Progress", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn", "utils/generated/torchtnt.utils.stateful.MultiStateful", "utils/generated/torchtnt.utils.stateful.Stateful", "utils/generated/torchtnt.utils.swa.AveragedModel", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config", "utils/generated/torchtnt.utils.test_utils.is_asan", "utils/generated/torchtnt.utils.test_utils.is_tsan", "utils/generated/torchtnt.utils.test_utils.skip_if_asan", "utils/generated/torchtnt.utils.timer.BoundedTimer", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer", "utils/generated/torchtnt.utils.timer.Timer", "utils/generated/torchtnt.utils.timer.TimerProtocol", "utils/generated/torchtnt.utils.timer.get_durations_histogram", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram", "utils/generated/torchtnt.utils.timer.get_timer_summary", "utils/generated/torchtnt.utils.timer.log_elapsed_time", "utils/generated/torchtnt.utils.tqdm.close_progress_bar", "utils/generated/torchtnt.utils.tqdm.create_progress_bar", "utils/generated/torchtnt.utils.tqdm.update_progress_bar", "utils/generated/torchtnt.utils.version.get_python_version", "utils/generated/torchtnt.utils.version.get_torch_version", "utils/generated/torchtnt.utils.version.is_windows", "utils/utils"], "filenames": ["checkpointing.rst", "distributed.rst", "examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.EarlyStopping.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SlowRankDetector.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "overview.rst", "utils/generated/torchtnt.utils.data.AbstractRandomDataset.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.device.copy_data_to_device.rst", "utils/generated/torchtnt.utils.device.get_device_from_env.rst", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats.rst", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats.rst", "utils/generated/torchtnt.utils.device.record_data_in_stream.rst", "utils/generated/torchtnt.utils.device.set_float32_precision.rst", "utils/generated/torchtnt.utils.distributed.PGWrapper.rst", "utils/generated/torchtnt.utils.distributed.all_gather_tensors.rst", "utils/generated/torchtnt.utils.distributed.barrier.rst", "utils/generated/torchtnt.utils.distributed.destroy_process_group.rst", "utils/generated/torchtnt.utils.distributed.get_file_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_global_rank.rst", "utils/generated/torchtnt.utils.distributed.get_local_rank.rst", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device.rst", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_world_size.rst", "utils/generated/torchtnt.utils.distributed.rank_zero_fn.rst", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm.rst", "utils/generated/torchtnt.utils.distributed.spawn_multi_process.rst", "utils/generated/torchtnt.utils.distributed.sync_bool.rst", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker.rst", "utils/generated/torchtnt.utils.env.init_from_env.rst", "utils/generated/torchtnt.utils.env.seed.rst", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode.rst", "utils/generated/torchtnt.utils.fsspec.get_filesystem.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.FileLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.MetricLogger.rst", "utils/generated/torchtnt.utils.loggers.StdoutLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/generated/torchtnt.utils.memory.RSSProfiler.rst", "utils/generated/torchtnt.utils.memory.measure_rss_deltas.rst", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler.rst", "utils/generated/torchtnt.utils.misc.days_to_secs.rst", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats.rst", "utils/generated/torchtnt.utils.module_summary.ModuleSummary.rst", "utils/generated/torchtnt.utils.module_summary.get_module_summary.rst", "utils/generated/torchtnt.utils.module_summary.get_summary_table.rst", "utils/generated/torchtnt.utils.module_summary.prune_module_summary.rst", "utils/generated/torchtnt.utils.oom.attach_oom_observer.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error.rst", "utils/generated/torchtnt.utils.oom.log_memory_snapshot.rst", "utils/generated/torchtnt.utils.optimizer.init_optim_state.rst", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype.rst", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_module.rst", "utils/generated/torchtnt.utils.progress.Progress.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn.rst", "utils/generated/torchtnt.utils.stateful.MultiStateful.rst", "utils/generated/torchtnt.utils.stateful.Stateful.rst", "utils/generated/torchtnt.utils.swa.AveragedModel.rst", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config.rst", "utils/generated/torchtnt.utils.test_utils.is_asan.rst", "utils/generated/torchtnt.utils.test_utils.is_tsan.rst", "utils/generated/torchtnt.utils.test_utils.skip_if_asan.rst", "utils/generated/torchtnt.utils.timer.BoundedTimer.rst", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer.rst", "utils/generated/torchtnt.utils.timer.Timer.rst", "utils/generated/torchtnt.utils.timer.TimerProtocol.rst", "utils/generated/torchtnt.utils.timer.get_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table.rst", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram.rst", "utils/generated/torchtnt.utils.timer.get_timer_summary.rst", "utils/generated/torchtnt.utils.timer.log_elapsed_time.rst", "utils/generated/torchtnt.utils.tqdm.close_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.create_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.update_progress_bar.rst", "utils/generated/torchtnt.utils.version.get_python_version.rst", "utils/generated/torchtnt.utils.version.get_torch_version.rst", "utils/generated/torchtnt.utils.version.is_windows.rst", "utils/utils.rst"], "titles": ["Checkpointing", "Distributed training", "Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "EarlyStopping", "GarbageCollector", "IterationTimeLogger", "Lambda", "LearningRateMonitor", "MemorySnapshot", "ModuleSummary", "PyTorchProfiler", "SlowRankDetector", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "TimeLimitInterrupter", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Overview", "torchtnt.utils.data.AbstractRandomDataset", "torchtnt.utils.data.AllDatasetBatchesIterator", "torchtnt.utils.data.CudaDataPrefetcher", "torchtnt.utils.data.InOrderIterator", "torchtnt.utils.data.MultiDataLoader", "torchtnt.utils.data.MultiIterator", "torchtnt.utils.data.RandomizedBatchSamplerIterator", "torchtnt.utils.data.RoundRobinIterator", "torchtnt.utils.device.copy_data_to_device", "torchtnt.utils.device.get_device_from_env", "torchtnt.utils.device.get_nvidia_smi_gpu_stats", "torchtnt.utils.device.get_psutil_cpu_stats", "torchtnt.utils.device.record_data_in_stream", "torchtnt.utils.device.set_float32_precision", "torchtnt.utils.distributed.PGWrapper", "torchtnt.utils.distributed.all_gather_tensors", "torchtnt.utils.distributed.barrier", "torchtnt.utils.distributed.destroy_process_group", "torchtnt.utils.distributed.get_file_init_method", "torchtnt.utils.distributed.get_global_rank", "torchtnt.utils.distributed.get_local_rank", "torchtnt.utils.distributed.get_process_group_backend_from_device", "torchtnt.utils.distributed.get_tcp_init_method", "torchtnt.utils.distributed.get_world_size", "torchtnt.utils.distributed.rank_zero_fn", "torchtnt.utils.distributed.revert_sync_batchnorm", "torchtnt.utils.distributed.spawn_multi_process", "torchtnt.utils.distributed.sync_bool", "torchtnt.utils.early_stop_checker.EarlyStopChecker", "torchtnt.utils.env.init_from_env", "torchtnt.utils.env.seed", "torchtnt.utils.flops.FlopTensorDispatchMode", "torchtnt.utils.fsspec.get_filesystem", "torchtnt.utils.loggers.CSVLogger", "torchtnt.utils.loggers.FileLogger", "torchtnt.utils.loggers.InMemoryLogger", "torchtnt.utils.loggers.JSONLogger", "torchtnt.utils.loggers.MetricLogger", "torchtnt.utils.loggers.StdoutLogger", "torchtnt.utils.loggers.TensorBoardLogger", "torchtnt.utils.memory.RSSProfiler", "torchtnt.utils.memory.measure_rss_deltas", "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "torchtnt.utils.misc.days_to_secs", "torchtnt.utils.misc.transfer_batch_norm_stats", "torchtnt.utils.module_summary.ModuleSummary", "torchtnt.utils.module_summary.get_module_summary", "torchtnt.utils.module_summary.get_summary_table", "torchtnt.utils.module_summary.prune_module_summary", "torchtnt.utils.oom.attach_oom_observer", "torchtnt.utils.oom.is_out_of_cpu_memory", "torchtnt.utils.oom.is_out_of_cuda_memory", "torchtnt.utils.oom.is_out_of_memory_error", "torchtnt.utils.oom.log_memory_snapshot", "torchtnt.utils.optimizer.init_optim_state", "torchtnt.utils.precision.convert_precision_str_to_dtype", "torchtnt.utils.prepare_module.DDPStrategy", "torchtnt.utils.prepare_module.FSDPStrategy", "torchtnt.utils.prepare_module.convert_str_to_strategy", "torchtnt.utils.prepare_module.prepare_ddp", "torchtnt.utils.prepare_module.prepare_fsdp", "torchtnt.utils.prepare_module.prepare_module", "torchtnt.utils.progress.Progress", "torchtnt.utils.progress.estimated_steps_in_epoch", "torchtnt.utils.progress.estimated_steps_in_fit", "torchtnt.utils.progress.estimated_steps_in_loop", "torchtnt.utils.rank_zero_log.rank_zero_critical", "torchtnt.utils.rank_zero_log.rank_zero_debug", "torchtnt.utils.rank_zero_log.rank_zero_error", "torchtnt.utils.rank_zero_log.rank_zero_info", "torchtnt.utils.rank_zero_log.rank_zero_print", "torchtnt.utils.rank_zero_log.rank_zero_warn", "torchtnt.utils.stateful.MultiStateful", "torchtnt.utils.stateful.Stateful", "torchtnt.utils.swa.AveragedModel", "torchtnt.utils.test_utils.get_pet_launch_config", "torchtnt.utils.test_utils.is_asan", "torchtnt.utils.test_utils.is_tsan", "torchtnt.utils.test_utils.skip_if_asan", "torchtnt.utils.timer.BoundedTimer", "torchtnt.utils.timer.FullSyncPeriodicTimer", "torchtnt.utils.timer.Timer", "torchtnt.utils.timer.TimerProtocol", "torchtnt.utils.timer.get_durations_histogram", "torchtnt.utils.timer.get_recorded_durations_table", "torchtnt.utils.timer.get_synced_durations_histogram", "torchtnt.utils.timer.get_synced_timer_histogram", "torchtnt.utils.timer.get_timer_summary", "torchtnt.utils.timer.log_elapsed_time", "torchtnt.utils.tqdm.close_progress_bar", "torchtnt.utils.tqdm.create_progress_bar", "torchtnt.utils.tqdm.update_progress_bar", "torchtnt.utils.version.get_python_version", "torchtnt.utils.version.get_torch_version", "torchtnt.utils.version.is_windows", "Utils"], "terms": {"torchtnt": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28], "offer": [0, 1, 3, 4, 21, 26, 28], "via": [0, 36], "torchsnapshotsav": 0, "which": [0, 1, 3, 4, 5, 6, 10, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 31, 33, 37, 41, 42, 54, 56, 57, 70, 71, 88, 89, 90, 108, 110, 116], "us": [0, 1, 2, 3, 4, 5, 6, 8, 13, 14, 15, 16, 20, 21, 23, 24, 25, 26, 28, 31, 35, 40, 41, 42, 43, 45, 47, 48, 49, 51, 52, 53, 55, 56, 58, 59, 61, 68, 75, 83, 87, 90, 103, 114, 115, 119, 124], "torchsnapshot": [0, 21], "under": [0, 21, 26], "hood": 0, "modul": [0, 1, 3, 5, 6, 14, 19, 23, 25, 26, 27, 28, 54, 59, 60, 73, 74, 75, 77, 86, 88, 89, 90, 101, 103], "nn": [0, 1, 3, 26, 28, 54, 88, 89, 101], "linear": [0, 1, 28, 54, 88, 89], "input_dim": [0, 1], "1": [0, 1, 6, 8, 9, 10, 16, 18, 20, 28, 30, 31, 32, 35, 36, 52, 53, 56, 57, 59, 60, 67, 75, 76, 77, 88, 89, 122], "unit": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 27, 28], "myunit": [0, 11, 26, 28], "tss": 0, "dirpath": [0, 21], "your_dirpath_her": 0, "save_every_n_train_step": [0, 21], "100": [0, 16, 29, 54, 62, 65, 112, 114, 115], "save_every_n_epoch": [0, 21], "2": [0, 3, 20, 30, 31, 32, 35, 36, 56, 59, 67, 76], "load": [0, 1, 21, 31, 83, 102], "latest": [0, 27], "exist": [0, 21, 83], "latest_checkpoint_dir": 0, "restore_from_latest": 0, "train_dataload": [0, 4, 6, 21, 25, 28, 93], "dataload": [0, 3, 5, 6, 11, 21, 23, 24, 25, 26, 28, 30, 31, 32, 33, 34, 35, 36, 71, 92, 94, 119], "train": [0, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 68, 71, 93, 104, 109, 124], "callback": [0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 27], "There": [0, 21, 28], "built": [0, 28], "support": [0, 3, 30, 32, 33, 34, 36, 38, 56, 75], "save": [0, 7, 13, 21, 71, 78, 82, 101, 102], "distribut": [0, 8, 9, 18, 21, 27, 28, 38, 58, 68, 87, 104], "ddp": [0, 1, 3, 28, 85, 88, 90], "fsdp": [0, 1, 3, 21, 28, 89, 90, 103], "The": [0, 1, 2, 3, 5, 6, 7, 8, 9, 14, 20, 21, 23, 25, 26, 28, 29, 37, 41, 42, 47, 54, 56, 58, 60, 67, 69, 70, 71, 75, 77, 78, 82, 103, 104, 108, 112, 114, 115, 119], "state": [0, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 26, 27, 28, 53, 83], "dict": [0, 14, 21, 30, 32, 33, 39, 40, 69, 83, 101, 112, 113, 114, 115], "type": [0, 14, 21, 26, 28, 29, 33, 39, 40, 44, 53, 58, 74], "can": [0, 1, 2, 3, 4, 5, 6, 9, 20, 21, 23, 24, 25, 26, 27, 28, 31, 32, 34, 35, 36, 53, 68, 71, 124], "specifi": [0, 13, 18, 20, 26, 28, 56, 71, 87, 103, 119], "fsdpstrategi": [0, 1, 3, 87, 89], "s": [0, 2, 3, 5, 6, 9, 21, 23, 25, 26, 33, 56, 58, 75, 115], "state_dict_typ": [0, 86], "argument": [0, 1, 3, 5, 6, 23, 25, 37, 68, 75, 103], "like": [0, 1, 3, 16, 21, 34, 41, 83, 103], "so": [0, 1, 3, 27, 67, 71, 119], "fsdp_strategi": [0, 1], "set": [0, 1, 5, 6, 17, 21, 23, 25, 30, 35, 38, 42, 49, 57, 58, 59, 67, 69, 70, 71, 76, 82, 88, 89, 90, 108, 110, 117], "sharded_state_dict": 0, "prepare_fsdp": [0, 1], "strategi": [0, 1, 3, 28, 36, 85, 86, 87, 88, 89, 90], "Or": 0, "you": [0, 1, 3, 16, 21, 26, 27, 75], "manual": [0, 28], "thi": [0, 1, 3, 4, 6, 7, 8, 9, 13, 16, 20, 21, 22, 26, 29, 30, 31, 32, 33, 35, 36, 38, 41, 44, 45, 51, 53, 54, 56, 57, 58, 59, 67, 68, 74, 78, 82, 83, 90, 103, 108], "set_state_dict_typ": [0, 21], "statedicttyp": [0, 86], "when": [0, 1, 2, 3, 4, 7, 11, 13, 14, 20, 21, 22, 24, 30, 31, 41, 45, 57, 61, 69, 70, 78, 108], "your": [0, 1, 4, 13, 26], "pass": [0, 1, 3, 4, 16, 21, 26, 28, 33, 37, 62, 68, 75, 84, 87, 103, 112], "restoreopt": [0, 21], "avoid": [0, 41, 59, 109], "optim": [0, 3, 5, 6, 12, 23, 25, 26, 27, 28, 101, 103], "learn": [0, 3, 12, 26], "rate": [0, 3, 12, 18, 26], "schedul": [0, 3, 12, 26], "your_unit": 0, "restore_opt": [0, 21], "restore_optim": 0, "fals": [0, 1, 21, 33, 62, 65, 71, 76, 85, 86, 90, 103, 110], "restore_lr_schedul": 0, "sometim": 0, "mai": [0, 5, 6, 21, 23, 25, 44, 83, 101], "help": [0, 1, 22], "keep": [0, 14, 21, 71, 77], "track": [0, 5, 6, 12, 20, 23, 25, 71, 91], "how": [0, 2, 3, 6, 20, 26, 30, 32, 33, 34, 35, 36], "perform": [0, 3, 5, 6, 9, 21, 23, 25, 26, 108, 110], "done": [0, 5, 6, 23, 25, 30, 36, 109], "bestcheckpointconfig": [0, 21], "param": [0, 3, 21, 85, 90, 103], "best_checkpoint_config": [0, 21], "monitored_metr": 0, "train_loss": [0, 28], "mode": [0, 5, 6, 23, 25, 57, 107], "min": [0, 57], "By": [0, 7, 9, 21, 32, 35, 41], "monitor": [0, 8, 21, 28, 57], "expect": [0, 1], "trainunit": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 28], "have": [0, 3, 21, 26, 28, 44, 54, 67, 101], "attribut": [0, 8, 21, 29, 57, 62, 63, 64, 65, 68, 74, 85, 86, 91, 103, 108, 110, 111], "time": [0, 5, 6, 9, 10, 16, 20, 21, 23, 24, 25, 62, 72, 74, 83, 108, 109, 110, 111, 113, 117], "cast": 0, "valu": [0, 3, 8, 21, 30, 32, 33, 34, 35, 36, 39, 40, 44, 55, 56, 58, 59, 67, 69, 75, 94, 112, 114, 115], "float": [0, 8, 21, 28, 39, 40, 56, 57, 92, 103, 112, 113, 114, 115], "append": [0, 70, 82], "path": [0, 7, 21, 61, 62, 63, 65, 68], "name": [0, 4, 7, 14, 21, 30, 32, 33, 34, 35, 36, 62, 67, 69, 74, 112, 114, 115, 117], "comput": [0, 3, 28, 31, 112, 114, 115], "kept": [0, 21, 108], "up": [0, 9, 24, 90], "date": 0, "appropri": [0, 21, 28, 38, 61], "user": [0, 1, 3, 13, 15, 21, 24, 26, 28, 31, 71, 103], "later": 0, "restore_from_best": 0, "metric_nam": 0, "If": [0, 1, 3, 8, 14, 16, 20, 21, 26, 27, 38, 39, 45, 47, 51, 54, 56, 57, 58, 59, 68, 71, 75, 77, 82, 93, 103, 108, 110, 112, 114, 115, 116, 117], "d": [0, 54], "valid": [0, 21], "sai": 0, "loss": [0, 3, 26, 28, 67], "after": [0, 3, 4, 6, 7, 8, 9, 10, 13, 15, 16, 18, 19, 20, 21, 22, 24, 26, 28, 35, 57, 67, 68, 83, 108, 110], "each": [0, 3, 7, 9, 11, 12, 16, 21, 24, 26, 29, 35, 44, 67, 112, 114, 115], "eval": [0, 3, 4, 5, 6, 9, 10, 11, 13, 15, 17, 18, 21, 23, 24, 26, 28, 93], "epoch": [0, 3, 4, 5, 6, 8, 11, 12, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 92, 93, 94, 119], "dure": [0, 3, 4, 5, 6, 7, 11, 13, 21, 23, 24, 25, 91], "fit": [0, 3, 4, 21, 24, 26, 27, 28, 93], "save_every_n_eval_epoch": [0, 21], "flag": [0, 3, 21, 90], "instead": [0, 21, 48, 52, 54], "eval_loss": 0, "And": 0, "onli": [0, 3, 8, 18, 21, 24, 38, 41, 53, 56, 58, 62, 63, 65, 68, 75, 78, 82, 83, 95, 96, 97, 98, 99, 100, 101, 103], "top": [0, 21, 27, 28], "three": [0, 26, 28, 30], "keep_last_n_checkpoint": [0, 21], "3": [0, 24, 30, 32, 35, 36, 56, 60, 121], "core": [1, 3, 26], "tnt": [1, 2, 27, 28], "framework": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 29, 124], "make": [1, 9, 13, 16, 27, 56, 67], "assumpt": 1, "about": [1, 3, 24, 26, 41], "devic": [1, 3, 16, 27, 28, 31, 50, 54, 58, 78, 82, 85, 88, 89, 90, 103], "handl": [1, 3, 28, 61], "configur": [1, 3, 9, 21], "own": [1, 4], "As": [1, 9, 41], "conveni": [1, 3, 9, 26, 58, 91], "autounit": [1, 27, 28], "who": [1, 3, 28], "prefer": [1, 28], "automat": [1, 3, 9, 28, 51, 103], "provid": [1, 7, 20, 21, 29, 32, 33, 34, 35, 56, 82], "checkpoint": [1, 3, 4, 21, 27, 28, 83, 90, 91, 102], "model": [1, 2, 3, 4, 9, 13, 21, 26, 58, 60, 71, 73, 103], "ar": [1, 3, 4, 16, 20, 21, 26, 27, 28, 30, 32, 33, 34, 35, 36, 44, 56, 62, 70, 71, 75, 77, 78, 82, 83, 103, 107, 112, 114, 115, 124], "evalunit": [1, 3, 4, 5, 6, 7, 9, 10, 11, 13, 14, 15, 17, 18, 21, 28], "predictunit": [1, 3, 4, 7, 9, 10, 11, 13, 14, 15, 17, 18, 21, 23, 28], "interfac": [1, 3, 7, 26, 28, 102], "initi": [1, 3, 13, 18, 21, 43, 45, 46, 47, 48, 51, 52, 56, 58, 60, 68, 69, 70, 83, 104], "cuda": [1, 5, 6, 17, 23, 25, 28, 31, 38, 41, 54, 78, 80, 82, 88, 89, 108, 110, 117], "applic": [1, 9, 21, 58], "along": [1, 112, 114, 115], "global": [1, 20, 45, 46, 47, 51, 53, 58, 59, 114, 115], "process": [1, 7, 9, 16, 20, 21, 40, 43, 44, 45, 46, 50, 51, 55, 56, 58, 68, 104, 109, 114, 115], "group": [1, 12, 16, 20, 21, 44, 45, 46, 50, 56, 58, 68, 114, 115], "from": [1, 3, 4, 5, 6, 11, 14, 16, 21, 23, 25, 26, 27, 28, 30, 32, 34, 35, 39, 41, 44, 50, 53, 58, 60, 64, 67, 68, 72, 83, 95, 96, 97, 98, 99, 100, 104, 109, 112, 114, 119], "torch": [1, 3, 5, 6, 10, 15, 19, 21, 23, 25, 26, 28, 30, 31, 32, 35, 36, 37, 38, 39, 41, 42, 45, 48, 52, 54, 56, 58, 59, 60, 84, 88, 89, 90, 103, 104, 108, 110], "we": [1, 4, 9, 28, 31, 41, 75, 101, 107], "function": [1, 3, 4, 11, 14, 26, 33, 34, 37, 38, 44, 45, 47, 50, 51, 53, 54, 55, 56, 58, 59, 75, 78, 83, 99, 104, 113], "init_from_env": 1, "work": [1, 44, 83], "torchelast": 1, "should": [1, 3, 4, 6, 7, 20, 21, 26, 29, 31, 37, 53, 54, 56, 57, 68, 108, 112, 114, 115], "invok": [1, 28, 45], "begin": [1, 22, 58], "script": [1, 13, 58], "simpli": 1, "wrap": [1, 45, 53, 88, 89, 103], "around": [1, 27, 28, 43], "move": [1, 10, 28, 31, 32, 88, 89, 90], "device_id": 1, "index": [1, 34, 38], "distributeddataparallel": [1, 85, 88], "also": [1, 3, 16, 21, 27, 28, 33, 34, 38], "prepare_ddp": 1, "assist": 1, "either": [1, 3, 10, 12, 17, 19, 20, 22, 26], "string": [1, 3, 7, 20, 76, 84, 87, 90], "my_auto_unit": 1, "myautounit": 1, "dataclass": [1, 3, 30, 32, 33, 34, 35, 36, 85, 86, 87], "ddpstrategi": [1, 87, 88], "want": [1, 3, 14, 21, 26, 28], "custom": [1, 3, 21, 26, 29, 32, 103], "ddp_strategi": 1, "broadcast_buff": [1, 85], "check_reduct": [1, 85], "true": [1, 3, 21, 56, 57, 62, 63, 65, 71, 76, 79, 80, 81, 85, 86, 88, 89, 90, 103, 108, 110, 117], "one": [1, 3, 7, 8, 20, 26, 32, 36, 46, 54, 57, 58, 90, 101], "more": [1, 2, 3, 21, 28, 31, 33, 34, 42, 45, 47, 51, 54, 58, 59, 75, 78, 82, 103], "fullyshardeddataparallel": [1, 86, 89], "forward_prefetch": [1, 86], "limit_all_gath": [1, 86, 89], "show": 2, "basic": [2, 4, 26, 28], "It": [2, 13, 16, 18, 20, 27, 28, 33, 53, 71, 74], "found": [2, 39], "here": [2, 26, 28, 47, 51, 58], "http": [2, 3, 13, 19, 21, 27, 31, 34, 41, 42, 47, 49, 51, 58, 59, 60, 90, 103], "github": [2, 13, 27, 103], "com": [2, 27, 103], "pytorch": [2, 3, 5, 6, 15, 19, 21, 23, 25, 27, 28, 31, 34, 41, 42, 47, 49, 51, 58, 59, 60, 75, 78, 83, 90, 103, 122], "blob": [2, 103], "master": [2, 27], "train_unit_exampl": 2, "py": [2, 103], "less": [2, 71, 77], "code": [2, 3, 4, 9, 15, 26], "featur": 2, "enabl": [2, 3, 21, 53, 59, 90, 108, 110], "out": [2, 4, 78, 103], "box": [2, 4], "auto_unit_exampl": 2, "datapip": 2, "dataloader2": [2, 5, 6, 23, 25], "torchdata_train_exampl": 2, "convnet": 2, "dataset": [2, 3, 22, 26, 29, 30, 32, 35, 36], "main": [2, 21, 27, 28, 103], "class": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 43, 57, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 74, 85, 86, 91, 101, 102, 103, 108, 109, 110, 111], "auto_unit": 3, "arg": [3, 11, 14, 28, 37, 55, 66, 68, 95, 96, 97, 98, 99, 100, 102, 111], "kwarg": [3, 14, 37, 55, 61, 66, 68, 75, 95, 96, 97, 98, 99, 100, 102, 108, 111], "sourc": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123], "stochast": 3, "gradient": [3, 9, 28], "descent": 3, "would": 3, "data": [3, 4, 5, 6, 11, 22, 23, 25, 26, 27, 28, 37, 41, 64, 67, 90, 119], "parallel": [3, 90], "replic": [3, 21], "them": [3, 20, 28, 31, 67], "subclass": [3, 4, 6, 26, 28, 29, 33], "implement": [3, 5, 6, 7, 23, 25, 26, 28, 29, 60, 108, 110], "train_step": [3, 6, 16, 25, 26, 28], "eval_step": [3, 5, 6, 26], "predict_step": [3, 23, 26, 28], "method": [3, 21, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 43, 47, 51, 55, 57, 58, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 74, 85, 86, 91, 101, 102, 103, 108, 109, 110, 111], "For": [3, 20, 21, 33, 34, 42, 45, 47, 51, 58, 59, 78, 82], "run": [3, 5, 6, 9, 11, 16, 23, 24, 25, 26, 27, 49, 75, 78, 82, 93, 105, 106, 107, 121, 122, 123], "forward": [3, 60, 74, 75], "backward": [3, 26, 28, 60, 74, 90], "step": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 28, 62, 63, 65, 67, 71, 83, 92, 93, 94, 103, 109, 119, 120], "To": [3, 4, 26, 27, 75], "benefit": 3, "must": [3, 7, 8, 9, 20, 21, 28, 57, 58, 68, 75, 90, 103], "compute_loss": [3, 28], "configure_optimizers_and_lr_schedul": [3, 28], "addition": [3, 59], "option": [3, 4, 5, 6, 10, 11, 14, 16, 18, 20, 21, 23, 24, 25, 26, 28, 33, 43, 44, 47, 51, 53, 54, 56, 57, 58, 59, 62, 65, 71, 72, 75, 78, 82, 84, 85, 86, 88, 89, 90, 92, 93, 94, 95, 96, 97, 98, 100, 103, 107, 110, 114, 115, 117, 119], "hook": [3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 26, 28, 85], "on_train_step_end": [3, 4, 6, 8, 9, 10, 11, 13, 15, 16, 18, 20, 25, 28], "on_eval_step_end": [3, 4, 5, 9, 10, 11, 13, 15, 18], "on_predict_step_end": [3, 4, 7, 9, 10, 11, 13, 15, 18, 23], "overrid": [3, 26], "lr": [3, 28], "step_lr_schedul": 3, "case": [3, 26, 28, 44, 56], "thei": [3, 21, 67], "logic": [3, 4, 16, 26, 33, 34], "Then": [3, 26], "evalu": [3, 4, 6, 9, 11, 14, 15, 18, 21, 24, 26, 27, 28], "predict": [3, 4, 7, 9, 10, 11, 13, 14, 15, 17, 18, 24, 26, 27, 28], "entri": [3, 4, 21, 24, 28, 78], "point": [3, 4, 9, 24, 26, 28, 45, 67], "normal": 3, "advanc": 3, "directli": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 28, 30, 31, 32, 34, 35, 36, 37, 39, 41, 42, 44, 47, 51, 53, 54, 55, 56, 57, 58, 59, 60, 62, 63, 65, 67, 68, 70, 71, 74, 75, 76, 77, 78, 82, 83, 84, 87, 88, 89, 90, 103, 104, 108, 110, 112, 114, 115, 116, 117, 119], "step_lr_interv": 3, "whether": [3, 8, 17, 20, 21, 24, 41, 57, 62, 74, 103, 108, 110, 117], "lr_schedul": [3, 5, 6, 23, 25, 26, 28], "everi": [3, 9, 16, 17, 20, 21, 22, 28], "default": [3, 7, 9, 14, 16, 17, 18, 21, 26, 29, 32, 33, 35, 41, 44, 47, 49, 50, 51, 54, 56, 58, 59, 62, 67, 69, 71, 78, 82, 87, 108, 110, 114, 115, 117, 119], "precis": [3, 27, 28, 42, 58, 67], "mix": [3, 28], "dtype": [3, 84], "accept": [3, 11, 101], "fp32": 3, "fp16": 3, "bf16": 3, "gradient_accumulation_step": [3, 28], "mani": 3, "batch": [3, 4, 11, 26, 28, 30, 31, 32, 34, 35, 36, 71, 73, 85], "accumul": [3, 28], "over": [3, 26, 28, 30, 32, 33, 34, 35, 36], "detect_anomali": 3, "anomali": [3, 28], "detect": [3, 16, 28], "autograd": 3, "engin": 3, "org": [3, 19, 21, 31, 34, 41, 42, 47, 49, 51, 58, 59, 60, 90], "doc": [3, 19, 31, 41, 42, 47, 49, 51, 58, 59, 90], "stabl": [3, 19, 31, 41, 42, 47, 49, 51, 58, 59, 90], "html": [3, 13, 19, 21, 31, 34, 41, 42, 47, 49, 51, 58, 59, 90], "clip_grad_norm": 3, "max": [3, 5, 6, 23, 25, 57, 119], "norm": [3, 73, 85], "clip": [3, 28], "gener": [3, 4, 9, 14, 21, 33, 34, 41, 42, 59, 67, 70, 75, 76, 90, 113, 116, 117], "util": [3, 5, 6, 10, 14, 19, 21, 23, 25], "clip_grad_norm_": 3, "clip_grad_valu": 3, "clip_grad_value_": 3, "swa_param": 3, "weight": [3, 35, 103], "averag": [3, 10, 103], "torch_compile_param": [3, 90], "compil": [3, 28, 90], "activation_checkpoint_param": [3, 90], "activ": [3, 14, 24, 75, 90], "creat": [3, 9, 26, 28, 41, 54, 68], "enable_compiled_autograd": [3, 90], "compiled_autograd": [3, 90], "an": [3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 15, 16, 18, 20, 21, 23, 24, 25, 26, 28, 29, 31, 33, 51, 56, 57, 67, 77, 78, 81, 84, 87, 88, 89, 90, 104, 111, 119], "experiment": [3, 90], "certain": [3, 41, 83], "through": [3, 33], "well": [3, 53, 71], "swaparam": 3, "swa": [3, 27], "shard": 3, "same": [3, 7, 9, 21, 26, 32, 33, 34, 44, 67, 73, 108], "avail": [3, 21, 38, 48, 52, 56, 58, 78, 82, 83, 108, 110, 117], "0": [3, 8, 18, 21, 28, 30, 32, 35, 36, 48, 49, 51, 53, 56, 57, 59, 62, 63, 65, 67, 68, 85, 91, 95, 96, 97, 98, 99, 100, 103, 109, 112, 114, 115, 121, 122], "higher": 3, "abstract": [3, 26, 27, 28, 29, 63, 66], "tdata": [3, 24], "tupl": [3, 14, 26, 28, 75], "tensor": [3, 8, 16, 26, 28, 30, 32, 35, 36, 41, 44, 75, 83, 85], "ani": [3, 5, 6, 14, 21, 23, 25, 26, 28, 37, 55, 56, 59, 61, 68, 75, 95, 96, 97, 98, 99, 100, 108], "call": [3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 28, 37, 41, 47, 51, 53, 68, 83, 99, 108, 110], "object": [3, 5, 6, 9, 20, 23, 24, 25, 26, 30, 32, 33, 34, 35, 36, 54, 60, 75, 77, 85, 92, 93, 94, 101, 115, 116, 119], "return": [3, 26, 28, 30, 32, 35, 36, 37, 39, 40, 44, 48, 52, 53, 54, 55, 56, 58, 61, 79, 80, 81, 93, 94, 104, 112, 114, 115], "contain": [3, 21, 24, 26, 27, 28, 29, 30, 31, 33, 54, 74, 75, 84], "output": [3, 7, 18, 24, 26, 28, 67, 74, 75, 78, 82, 119], "part": [3, 28], "lrschedul": [3, 101], "construct": [3, 31, 41, 68, 119], "upon": [3, 21], "A": [3, 4, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 30, 32, 33, 34, 35, 36, 39, 43, 51, 55, 60, 69, 70, 75, 83, 94, 108, 110, 112, 114, 115], "requir": [3, 26, 59, 60], "iter": [3, 5, 6, 10, 21, 22, 23, 24, 25, 26, 30, 31, 32, 33, 34, 35, 36, 86, 92, 93, 94, 119], "wish": [3, 26], "decor": [3, 26, 53], "inference_mod": [3, 26], "improv": [3, 8, 9, 26, 57], "metadata": [3, 26], "get_next_eval_batch": [3, 5, 26], "data_it": [3, 26], "union": [3, 4, 7, 10, 11, 12, 17, 18, 19, 20, 21, 22, 26, 30, 32, 33, 34, 35, 36, 54, 56, 59, 85, 86, 87, 90, 101, 119], "next": [3, 4, 11, 26, 32], "input": [3, 26, 28, 32, 54, 56, 59, 74, 112, 114, 115, 116], "otherwis": [3, 9, 26, 41, 48, 52, 103], "get": [3, 4, 18, 26, 34, 38, 39, 40, 47, 48, 49, 50, 51, 52, 121, 122], "get_next_predict_batch": [3, 23, 26], "get_next_train_batch": [3, 6, 25, 26], "int": [3, 5, 6, 8, 9, 10, 14, 16, 18, 20, 21, 23, 24, 25, 28, 29, 31, 47, 48, 49, 51, 52, 55, 56, 57, 59, 62, 63, 65, 67, 70, 72, 77, 78, 85, 86, 91, 92, 93, 94, 104, 108, 118, 119, 120], "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 41, 42, 43, 44, 45, 46, 47, 51, 53, 54, 56, 57, 58, 59, 60, 62, 63, 64, 65, 67, 68, 69, 70, 71, 73, 74, 75, 77, 78, 82, 83, 85, 86, 88, 89, 90, 91, 93, 94, 95, 96, 97, 98, 99, 100, 101, 103, 108, 109, 110, 114, 115, 117, 118, 119, 120], "end": [3, 4, 7, 8, 9, 10, 11, 13, 15, 16, 18, 19, 20, 21, 22, 24, 26, 28], "befor": [3, 4, 7, 9, 12, 13, 14, 15, 16, 17, 18, 20, 22, 26, 60, 62, 63, 65, 71, 108, 110], "updat": [3, 9, 18, 21, 27, 28, 103, 118, 120], "log": [3, 10, 12, 14, 16, 17, 19, 21, 22, 27, 28, 62, 63, 64, 65, 67, 68, 95, 96, 97, 98, 100, 108, 110, 117], "metric": [3, 8, 21, 27, 28, 57, 66, 67], "do": [3, 8, 27, 28, 67], "anyth": 3, "els": [3, 53, 62, 63, 65], "been": [3, 20, 30, 36, 58], "complet": [3, 21, 24, 119, 120], "on_train_epoch_end": [3, 4, 6, 8, 11, 16, 18, 19, 20, 22, 25, 26, 28], "note": [3, 13, 54, 59], "rememb": 3, "super": [3, 26, 28], "result": [3, 9, 28, 44, 56, 69, 109, 113], "trainstepresult": [3, 28], "total": [3, 21, 29, 93, 94], "extract": 3, "autopredictunit": 3, "str": [3, 4, 7, 8, 12, 14, 20, 21, 28, 30, 32, 33, 34, 35, 36, 39, 40, 42, 47, 50, 51, 54, 55, 56, 58, 59, 61, 62, 63, 65, 68, 71, 75, 76, 78, 82, 84, 86, 87, 90, 101, 112, 113, 114, 115, 116, 117, 119], "torchcompileparam": [3, 90], "bool": [3, 21, 24, 33, 56, 57, 62, 63, 65, 76, 79, 80, 81, 85, 86, 90, 103, 105, 106, 110, 117, 123], "tpredictdata": [3, 4, 7, 9, 10, 11, 13, 14, 15, 17, 18, 21, 23, 26], "extens": [4, 28], "supplement": [4, 21], "loop": [4, 5, 6, 9, 11, 20, 23, 24, 25, 26, 27, 28, 91, 94, 119], "addit": [4, 21, 26, 28, 41, 108], "good": [4, 67], "candid": 4, "ones": [4, 21], "re": [4, 60, 83], "across": [4, 7, 9, 21, 22, 45, 56, 59, 114, 115], "intend": [4, 28, 29, 58], "go": 4, "write": [4, 7, 22, 41, 62, 63, 65, 68, 82], "add": [4, 45], "below": [4, 5, 6, 23, 25, 26], "exampl": [4, 5, 6, 11, 20, 21, 23, 25, 26, 30, 31, 32, 33, 34, 35, 36, 53, 54, 55, 56, 60, 64, 67, 68, 71, 88, 89, 104, 121, 122], "print": [4, 11, 14, 17, 28, 30, 32, 35, 36, 56, 67, 76, 99], "messag": [4, 18, 81, 95, 96, 97, 98, 100, 119], "variou": [4, 27, 28], "execut": [4, 5, 6, 9, 23, 24, 25, 53, 57, 58], "import": [4, 5, 6, 9, 11, 23, 25, 26, 28, 53, 60, 64, 67, 68, 104], "tevalunit": [4, 28], "tpredictunit": [4, 28], "ttrainunit": [4, 28], "printingcallback": [4, 28], "def": [4, 11, 26, 28, 53], "on_train_start": [4, 6, 9, 11, 14, 15, 20, 21, 22, 25, 26, 28], "self": [4, 26, 28], "start": [4, 7, 9, 11, 12, 14, 15, 17, 18, 20, 21, 22, 24, 26, 28, 71, 103], "on_train_end": [4, 6, 9, 11, 15, 25, 26, 28], "on_eval_start": [4, 5, 9, 11, 14, 15, 26, 28], "on_eval_end": [4, 5, 9, 11, 15, 26, 28], "on_predict_start": [4, 7, 9, 11, 14, 15, 23, 26, 28], "on_predict_end": [4, 7, 9, 11, 15, 23, 26, 28], "instanti": [4, 13, 28, 71], "printing_callback": 4, "train_unit": [4, 25, 26], "properti": [4, 21, 24], "distinct": 4, "per": [4, 5, 6, 23, 24, 25, 67, 108, 119], "instanc": [4, 5, 6, 10, 13, 19, 21, 23, 24, 25, 33, 71, 87, 88, 89, 104], "debug": [4, 16, 24, 28, 96], "profil": [4, 15, 69, 71], "purpos": 4, "tevaldata": [4, 5, 6, 7, 9, 10, 11, 13, 14, 15, 17, 18, 21, 26], "on_eval_epoch_end": [4, 5, 11, 18, 26], "on_eval_epoch_start": [4, 5, 11, 17, 18, 26], "new": [4, 12, 17, 18, 26, 47, 54, 68], "on_eval_get_next_batch_end": [4, 11], "on_eval_step_start": [4, 5, 11, 17], "on_except": [4, 7, 11, 21], "ttraindata": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 26], "exc": [4, 7, 21], "baseexcept": [4, 7, 11, 21, 79, 80, 81], "except": [4, 5, 6, 7, 11, 21, 23, 25, 33, 79, 80, 81], "occur": [4, 7, 11, 21, 22, 78, 103], "on_predict_epoch_end": [4, 11, 18, 23, 26], "on_predict_epoch_start": [4, 11, 17, 18, 23, 26], "on_predict_get_next_batch_end": [4, 11], "on_predict_step_start": [4, 11, 17, 23], "on_train_epoch_start": [4, 6, 11, 12, 17, 18, 25, 26], "on_train_get_next_batch_end": [4, 11], "on_train_step_start": [4, 6, 11, 12, 17, 25], "sever": [4, 26, 28, 44], "pre": 4, "written": [4, 7, 68], "readi": 4, "eval_unit": [5, 26], "eval_dataload": [5, 6, 93], "max_steps_per_epoch": [5, 23, 24, 25, 92, 94, 119], "list": [5, 6, 7, 12, 14, 17, 21, 22, 23, 25, 44, 55, 69, 70, 112, 114], "timer": [5, 6, 23, 24, 25, 27], "timerprotocol": [5, 6, 23, 24, 25, 108, 110, 115, 116], "take": [5, 6, 9, 21, 23, 25], "modifi": [5, 6, 23, 24, 25, 26], "includ": [5, 6, 17, 23, 25, 27, 28, 34, 58, 85, 91], "etc": [5, 6, 14, 16, 21, 23, 25, 28, 33, 34, 55], "number": [5, 6, 9, 18, 21, 23, 24, 25, 29, 31, 44, 47, 51, 55, 57, 59, 62, 63, 65, 67, 74, 78, 92, 93, 94, 103, 104, 108, 119, 120], "mean": [5, 6, 23, 25, 60, 74, 112, 114, 115], "until": [5, 6, 23, 25, 30], "exhaust": [5, 6, 23, 25, 30, 32, 35, 36], "kei": [5, 6, 21, 23, 24, 25, 30, 32, 33, 34, 35, 36, 39, 40, 69], "event": [5, 6, 23, 24, 25, 68, 71, 117], "synchron": [5, 6, 9, 23, 25, 45, 47, 53, 56, 68, 108, 110, 114, 115, 117], "degrad": [5, 6, 23, 25], "myevalunit": [5, 26], "20": [5, 20, 23, 54], "pseudocod": [5, 6, 23, 25], "what": [5, 6, 21, 23, 25, 103], "doe": [5, 6, 8, 9, 23, 25, 83], "first": [5, 6, 20, 23, 25, 27, 83], "while": [5, 6, 23, 25, 30, 36], "try": [5, 6, 23, 25], "increment": [5, 6, 23, 25], "counter": [5, 6, 23, 25, 60], "stopiter": [5, 6, 23, 25], "break": [5, 6, 23, 25], "max_epoch": [6, 24, 25, 28], "max_step": [6, 24, 25, 92, 93, 94, 119], "max_train_steps_per_epoch": [6, 93], "max_eval_steps_per_epoch": [6, 93], "evaluate_every_n_step": [6, 24], "evaluate_every_n_epoch": [6, 24], "interleav": [6, 26, 28, 31], "both": [6, 20], "limit": [6, 20, 25], "infinit": [6, 25, 57], "unless": [6, 25], "stop": [6, 8, 20, 24, 25, 27, 30, 35, 36, 57], "often": [6, 20], "term": [6, 22, 24], "fit_unit": 6, "myfitunit": 6, "4": [6, 25, 30, 32, 35, 36, 56, 67], "header_row": 7, "dir_path": 7, "delimit": 7, "t": [7, 28, 37, 41, 59, 60, 93, 94], "filenam": [7, 47, 82], "csv": [7, 62], "file": [7, 13, 18, 47, 58, 62, 63, 65, 68, 71, 119], "simplifi": [7, 27, 28], "extend": [7, 26], "get_step_output_row": 7, "desir": [7, 53], "row": 7, "all": [7, 9, 13, 14, 21, 28, 30, 32, 34, 35, 44, 45, 54, 56, 62, 63, 65, 68, 116], "match": 7, "column": 7, "defin": [7, 20, 24, 26, 28, 33, 34, 36, 68, 88, 89, 102, 108, 111], "directori": [7, 13, 21, 71, 78, 82], "where": [7, 13, 18, 21, 26, 41, 44, 55, 71, 119], "separ": 7, "tab": 7, "monitored_attr": 8, "early_stop_check": 8, "earlystopcheck": 8, "interv": [8, 20, 28, 69, 70, 109], "liter": [8, 17, 20, 56, 57, 58, 103], "interval_freq": [8, 20], "check": [8, 16, 20, 57, 103], "earli": [8, 13, 27, 57], "rank": [8, 16, 18, 20, 21, 27, 47, 48, 49, 51, 53, 55, 56, 62, 63, 65, 67, 68, 95, 96, 97, 98, 99, 100, 104, 109, 114, 115], "step_interv": 9, "period": [9, 21, 69, 70], "garbag": 9, "collect": [9, 13, 21, 43, 68, 74], "In": [9, 26, 44, 56, 57], "fulli": 9, "program": [9, 38, 41, 58, 123], "multipl": [9, 41, 42, 58, 101], "These": [9, 26, 28, 124], "need": [9, 21, 26, 28, 41, 53, 103, 124], "commun": [9, 20, 21, 51, 55, 85], "other": [9, 16, 21, 56, 109], "especi": [9, 22], "overal": 9, "therefor": 9, "gate": 9, "slowest": [9, 16], "roughli": 9, "amount": [9, 20], "its": [9, 41, 74, 75], "straggler": 9, "python": [9, 59, 105, 106, 121], "trigger": [9, 16], "differ": [9, 16, 21, 26, 27, 28, 44, 67], "possibl": [9, 13, 20], "lead": 9, "frequenc": [9, 10, 16, 21, 24, 28], "tune": 9, "base": [9, 21, 29, 38, 58, 60, 81, 103], "hand": 9, "free": [9, 41, 51, 55, 71], "some": [9, 26, 83], "reap": 9, "minim": 9, "overhead": 9, "compar": [9, 16], "full": 9, "cleanup": 9, "logger": [10, 12, 16, 17, 19, 22, 27, 28, 95, 96, 97, 98, 100], "metriclogg": [10, 12, 16, 17, 22], "summarywrit": [10, 19, 68], "moving_avg_window": 10, "log_every_n_step": [10, 28], "scalar": 10, "tensorboard": [10, 19, 28, 68], "tensorboardlogg": [10, 19, 28], "control": [10, 13, 21, 26, 28, 59], "window": [10, 123], "callabl": [11, 14, 53, 55, 85, 86, 107], "retriev": 11, "mydataload": 11, "print_on_step_start": 11, "f": [11, 56], "eval_progress": 11, "num_steps_complet": [11, 28, 91, 92, 118, 119, 120], "lambda_cb": 11, "logging_interv": [12, 17], "associ": 12, "memory_snapshot_profil": 13, "memorysnapshotprofilerbas": 13, "memori": [13, 17, 27, 31, 41, 64, 71, 78, 82, 83], "snapshot": [13, 21, 71, 78, 82], "pickl": 13, "zdevito": 13, "io": 13, "2022": 13, "08": 13, "16": 13, "recommend": [13, 16, 28, 31], "ideal": [13, 60, 71], "sure": [13, 16, 27], "alloc": [13, 41, 71, 83], "captur": [13, 69], "max_depth": [14, 77], "process_fn": 14, "module_summari": 14, "_log_module_summary_t": 14, "module_input": [14, 60], "mutablemap": [14, 75], "summari": [14, 27, 74, 77, 116], "maximum": [14, 20, 24, 77, 78], "depth": [14, 77], "tabl": 14, "map": [14, 30, 32, 34, 35, 36, 39, 40, 112, 114, 115], "flop": [14, 27, 74, 75], "size": [14, 17, 29, 44, 52, 69, 70, 74, 75], "rais": [14, 20, 33, 38, 39, 57, 59, 71, 77, 84, 87, 108, 110, 112, 114, 115, 116, 117], "runtimeerror": [14, 38], "torchev": 14, "instal": 14, "context": [15, 38, 60, 70], "manag": [15, 21, 60, 70], "check_every_n_step": 16, "check_every_n_epoch": 16, "pg": [16, 43, 56, 114, 115], "processgroup": [16, 21, 43, 44, 56, 85, 86, 109, 114, 115], "slow": 16, "n": [16, 21, 56], "lag": 16, "behind": 16, "caus": 16, "nccl": [16, 55], "timeout": [16, 58], "between": [16, 20, 57, 73], "fastest": 16, "report": 16, "all_gather_tensor": 16, "store": [16, 63, 65, 69, 101, 108, 110, 111], "infer": [16, 28, 119], "environ": [16, 18, 27, 38, 47, 49, 51, 58, 68, 122], "system": [17, 47, 123], "stat": [17, 28, 39, 40], "cpu": [17, 24, 38, 40, 54, 79], "usag": 17, "resid": [17, 69, 70], "gpu": [17, 38, 39, 108, 110], "refresh_r": [18, 118, 120], "textio": [18, 119], "stringio": [18, 119], "progress": [18, 21, 22, 27, 28, 101, 118, 119, 120], "bar": [18, 118, 119, 120], "visual": [18, 22, 71], "determin": [18, 20, 42, 57, 59, 105, 106], "sy": [18, 119], "stderr": [18, 119], "histogram": [19, 112, 114], "writer": 19, "durat": [20, 112, 113, 114, 115], "timedelta": [20, 58, 69, 70, 109], "timestamp": 20, "datetim": [20, 58, 69, 70], "spent": 20, "reach": [20, 108], "job": 20, "absolut": [20, 57], "At": 20, "least": [20, 56], "condit": [20, 48, 52], "met": [20, 48, 52], "spend": 20, "form": 20, "dd": 20, "hh": 20, "mm": 20, "dai": [20, 72], "hour": 20, "minut": [20, 58], "00": 20, "indic": [20, 21, 30, 32, 33, 34, 35, 36, 94], "even": [20, 21], "ha": [20, 27, 28, 30, 33, 34, 36, 57, 58, 116], "yet": 20, "timezon": 20, "awar": 20, "exceed": 20, "two": [20, 27, 28, 36, 73], "valueerror": [20, 57, 59, 71, 77, 84, 87, 108, 110, 112, 114, 115, 116, 117], "i": [20, 44, 55], "e": [20, 26, 28, 76], "process_group": [21, 85, 86], "async_checkpoint": 21, "storage_opt": 21, "knob_opt": 21, "knobopt": 21, "appstatemixin": 21, "random": [21, 29, 59], "epoch_": 21, "_step_": 21, "parent": [21, 24], "intra": 21, "most": [21, 117], "recent": 21, "excess": 21, "present": 21, "oldest": [21, 108], "delet": 21, "clean": 21, "best": 21, "config": [21, 104], "read": [21, 24, 33, 34], "off": 21, "prior": 21, "entir": 21, "world": [21, 43, 44, 52], "asynchron": [21, 62, 109], "glob": 21, "pattern": 21, "inform": [21, 24, 42, 47, 51, 54, 58, 74, 76, 78, 82], "see": [21, 28, 42, 47, 51, 58, 59, 78, 82, 103], "api_refer": 21, "safer": 21, "realli": 21, "thing": 21, "grad_scal": 21, "mark": 21, "unsur": 21, "leav": 21, "field": 21, "unset": 21, "keyword": [21, 37, 68], "storag": 21, "plugin": 21, "document": [21, 33, 34], "knob": 21, "constructor": 21, "oper": [21, 31, 42, 58, 59, 68, 123], "broadcast": [21, 44, 56], "state_dict": [21, 83, 91, 101], "castabl": 21, "maintain": [21, 27, 28], "accuraci": [21, 28, 64, 67, 68], "respons": 21, "reset": [21, 28, 60, 109, 111], "collis": 21, "app": [21, 43], "static": 21, "restor": [21, 83], "strict": 21, "skip": [21, 30, 33, 36, 103, 107], "filter": 21, "allow": [21, 26, 43, 103], "app_stat": 21, "vs": [22, 76], "predict_unit": [23, 26], "predict_dataload": 23, "mypredictunit": [23, 26], "entry_point": 24, "entrypoint": [24, 104], "train_stat": 24, "tstepoutput": 24, "eval_st": 24, "predict_st": 24, "phase": [24, 26], "active_phas": 24, "activephas": 24, "current": [24, 38, 56, 58, 75, 92, 94, 121, 122, 123], "One": 24, "meta": 24, "should_stop": 24, "termin": 24, "signal": [24, 57], "record": [24, 41, 71, 78, 112, 113, 114, 115, 116], "latenc": 24, "iteration_tim": 24, "alwai": 24, "without": [24, 57], "synchronis": 24, "step_output": 24, "last": 24, "mytrainunit": [25, 26], "concept": [26, 28], "repres": [26, 28, 85, 86], "primari": [26, 28], "place": [26, 28, 83], "organ": 26, "mutual": [26, 28], "exclus": [26, 28], "g": [26, 28, 76], "behavior": [26, 108], "fetch": [26, 47, 51], "simpl": [26, 64, 68], "typecheck": 26, "__init__": [26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 43, 57, 60, 62, 63, 64, 65, 66, 67, 68, 69, 71, 74, 85, 86, 91, 101, 102, 103, 108, 109, 110, 111], "_lrschedul": 26, "target": [26, 28], "binary_cross_entropy_with_logit": [26, 28], "zero_grad": [26, 28], "plan": 26, "refer": [26, 33, 34, 45], "my_unit": [26, 28], "librari": [27, 28, 59], "tool": [27, 28], "compon": [27, 28], "level": [27, 28], "repo": [27, 28], "lightweight": [27, 28], "grab": [27, 28], "bag": [27, 28], "independ": [27, 28, 124], "relat": [27, 28, 79, 80, 124], "wrapper": [27, 28, 43, 101], "publish": [27, 28], "pip": 27, "issu": [27, 43], "version": [27, 103], "just": 27, "git": 27, "upgrad": 27, "checker": 27, "filesystem": [27, 61], "spec": 27, "memorysnapshotprofil": 27, "oom": [27, 71], "prepar": 27, "zero": [27, 71, 83], "test": [27, 107], "tqdm": 27, "misc": 27, "welcom": 28, "descript": [28, 119], "immedi": 28, "combin": 28, "myexampleunit": 28, "_modul": 28, "_devic": 28, "_optim": 28, "_log_every_n_step": 28, "_accuraci": 28, "binaryaccuraci": 28, "_tb_logger": 28, "trainer": 28, "our": 28, "task": 28, "copy_data_to_devic": 28, "squeez": 28, "step_count": 28, "train_progress": 28, "acc": 28, "log_dict": [28, 67], "train_accuraci": 28, "train_accuracy_epoch": 28, "predictbatch": 28, "256": 28, "10": [28, 30, 32, 35, 36, 64, 68, 71], "1000": 28, "5": [28, 30, 32, 35, 36, 56, 71], "howev": 28, "don": [28, 59], "necessarili": 28, "themselv": 28, "appli": [28, 103, 108], "tb_logger": 28, "multiclassaccuraci": 28, "gamma": 28, "tlrschedul": 28, "adadelta": 28, "steplr": 28, "step_siz": 28, "nll_loss": 28, "_": 28, "mechan": [28, 30, 35, 36], "inject": 28, "within": [28, 38, 59], "wai": 28, "page": 28, "detail": [28, 33, 34, 59], "suit": 28, "rang": [28, 30, 32, 35, 36, 38, 56, 59, 108, 112, 114, 115], "concret": 29, "_generate_random_item": 29, "produc": 29, "singl": [29, 32, 43, 55, 75, 104], "item": [29, 30, 32, 35, 36], "titem": 29, "individual_dataload": [30, 32, 33, 34, 35, 36], "iteration_strategi": [30, 32, 33, 34, 35, 36], "alldatasetbatch": 30, "all_datasets_exhaust": [30, 35, 36], "finish": 30, "till": [30, 32, 36], "largest": [30, 36], "those": [30, 36], "smallest_dataset_exhaust": [30, 36], "onc": [30, 36, 41, 57], "smallest": [30, 36], "restart_until_all_datasets_exhaust": 30, "restart": 30, "format": [30, 32, 35, 36, 113], "dataloader_1_nam": 30, "batch_obtained_from_dataloader_1": 30, "dataloader_2_nam": 30, "batch_obtained_from_dataloader_2": 30, "loader": [30, 32, 35, 36], "batch_siz": [30, 32, 35, 36], "b": [30, 32, 35, 36], "15": [30, 32, 35, 36], "all_dataset_batch_strategi": 30, "stopping_mechan": [30, 35, 36], "stoppingmechan": [30, 35, 36], "combined_iter": [30, 32, 35, 36], "6": [30, 32, 35, 36], "7": [30, 32, 35, 36], "8": [30, 32, 35, 36, 104, 121], "9": [30, 32, 35, 36], "11": [30, 32, 35, 36], "12": [30, 32, 35, 36, 122], "13": [30, 32, 35, 36, 60, 75], "14": [30, 32, 35, 36], "data_iter": 31, "num_prefetch_batch": 31, "prefetch": 31, "host": [31, 78, 82], "copi": [31, 37, 60, 103], "effect": 31, "leverag": 31, "pin": 31, "data_prefetch": 31, "alreadi": [31, 46, 58, 103], "inord": 32, "order": [32, 34, 36, 67, 109, 117], "overridden": 32, "repetit": 32, "dataloader_nam": [32, 35, 36], "batch_from_dataload": [32, 35, 36], "randomizedbatchsampl": [32, 35], "in_order_strategi": 32, "randomizedbatchsampleriter": 32, "dataiterationstrategi": [33, 34], "iterator_cl": 33, "multiiter": 33, "ignore_empty_data": 33, "cycl": [33, 34, 36], "individu": [33, 34], "dictionari": [33, 108, 110, 112, 114, 115], "torchdata": [33, 34], "multi": [33, 34, 55, 104], "achiev": [33, 34], "mux": [33, 34], "mux_longest": [33, 34], "zip": [33, 34], "pleas": [33, 34, 45], "given": [34, 57, 61, 109, 116, 117], "accompani": 34, "particular": 34, "beta": 34, "randomli": 35, "sampl": [35, 108], "chang": [35, 57], "anoth": [35, 41], "randomized_batch_sampl": 35, "roundrobin": 36, "robinrobin": 36, "round_robin_strategi": 36, "recurs": 37, "posit": [37, 68], "correct": 37, "mp": 38, "reli": [38, 83], "local_rank": [38, 49], "variabl": [38, 49, 68], "made": 38, "launcher": [38, 104], "outsid": [38, 59], "gpustat": 39, "nvidia": 39, "smi": 39, "utilization_gpu_perc": 39, "utilization_memory_perc": 39, "fan_speed_perc": 39, "memory_used_mb": 39, "memory_free_mb": 39, "temperature_gpu_celsiu": 39, "temperature_memory_celsiu": 39, "filenotfounderror": 39, "command": 39, "cpustat": 40, "psutil": 40, "cpu_vm_perc": 40, "cpu_perc": 40, "cpu_swap_perc": 40, "worker_cpu_time_us": 40, "worker_cpu_time_system": 40, "worker_rss": 40, "stream": [41, 117], "element": 41, "being": [41, 117], "reus": 41, "mention": 41, "record_stream": 41, "cach": 41, "freed": 41, "newli": 41, "trace": [41, 78], "still": 41, "wa": 41, "tell": 41, "might": [41, 101], "underli": 41, "longer": 41, "creator": 41, "notabl": 41, "trick": 41, "high": [42, 58], "float32": 42, "matrix": [42, 58], "convolut": 42, "set_float32_matmul_precis": 42, "backend": [42, 50, 55, 58], "cudnn": [42, 59], "allow_tf32": 42, "datatyp": 42, "consist": 43, "fashion": 43, "regardless": 43, "follow": [43, 58, 67, 74], "scenario": 43, "gather": 44, "onto": 44, "dimens": [44, 54], "pad": 44, "trim": 44, "secur": 44, "equal": [44, 58, 71], "workload": 44, "sync": [44, 85, 112, 114, 115], "gathered_result": 44, "correspond": 44, "granular": 45, "pgwrapper": 45, "destroi": 46, "world_siz": [47, 51, 52, 55], "init": [47, 51], "tcp": [47, 51, 58], "protocol": [47, 51, 111], "share": 47, "worker": [47, 51], "get_world_s": [47, 51], "get_global_rank": [47, 51], "temporari": 47, "env": [48, 52], "var": [48, 52], "neither": [48, 52, 71], "popul": 49, "elast": 49, "hostnam": 51, "port": [51, 55], "address": 51, "belong": [51, 67], "localhost": [51, 55], "select": 51, "fn": 53, "treturn": [53, 55, 107], "judici": 53, "never": 53, "veri": 53, "carefulli": 53, "mutat": 53, "local": 53, "foo": 53, "x": 53, "wrapped_fn": 53, "helper": [54, 113], "convert": [54, 72, 84, 87], "syncbatchnorm": 54, "layer": 54, "batchnorm": 54, "revert": 54, "convert_sync_batchnorm": 54, "origin": 54, "network": 54, "sequenti": 54, "batchnorm1d": 54, "sync_bn_modul": 54, "reverted_modul": 54, "method_arg": 55, "method_kwarg": 55, "spawn": 55, "node": [55, 104], "gloo": 55, "l": 55, "methods_kwarg": 55, "val": 56, "coherence_mod": 56, "rank_zero": 56, "boolean": 56, "member": 56, "manner": 56, "receiv": 56, "truth": 56, "integ": [56, 59, 119], "ratio": 56, "synced_v": 56, "iff": 56, "success": [56, 67], "patienc": 57, "min_delta": 57, "check_finit": 57, "threshold_mod": 57, "ab": 57, "rel": 57, "stopping_threshold": 57, "divergence_threshold": 57, "decreas": 57, "increas": 57, "minimum": 57, "qualifi": 57, "improvement_threshold": 57, "best_val": 57, "threshold": 57, "becom": 57, "nan": 57, "delta": [57, 69, 70], "beyond": 57, "wors": 57, "than": [57, 71, 77, 108], "device_typ": 58, "dist_init_method_typ": 58, "pg_backend": 58, "pg_timeout": 58, "second": [58, 72], "1800": 58, "float32_matmul_precis": 58, "launch": [58, 104], "spmd": 58, "style": [58, 103], "against": 58, "30": 58, "determinist": 59, "pseudo": 59, "commonli": 59, "numpi": 59, "error": [59, 78, 81, 97], "warn": [59, 100], "nondeterminist": 59, "benchmark": 59, "disabl": 59, "set_deterministic_debug_mod": 59, "algorithm": 59, "measur": [60, 69, 70, 109, 117], "count": 60, "dev": 60, "discuss": 60, "dispatch": 60, "505": 60, "torchvis": 60, "resnet18": 60, "randn": 60, "224": 60, "ftdm": 60, "flops_forward": 60, "deepcopi": [60, 103], "flop_count": 60, "flops_backward": 60, "abstractfilesystem": 61, "steps_before_flush": [62, 63, 65], "log_all_rank": [62, 63, 65], "async_writ": 62, "header": 62, "buffer": [62, 64], "flush": [62, 63, 65], "23": [64, 68], "56": [64, 68], "close": [64, 68, 118], "json": 65, "stdout": 67, "line": 67, "were": 67, "treat": 67, "opaqu": 67, "identifi": 67, "consecut": 67, "practic": 67, "digit": 67, "decim": 67, "rule": 67, "round": [67, 69], "usual": 67, "982378": 67, "23112": 67, "payload": 67, "99123": 67, "18787": 67, "9824": 67, "2311": 67, "9912": 67, "1879": 67, "On": 68, "extra": 68, "tmp": [68, 71], "tb_log": 68, "microsecond": [69, 70], "100000": [69, 70, 71], "rss": [69, 70], "baselin": [69, 70], "rss_deltas_byt": 69, "100m": 69, "byte": [69, 70, 74], "rss_delta": 70, "output_dir": [71, 78, 82], "memory_snapshot_param": 71, "memorysnapshotparam": 71, "histori": 71, "dump": 71, "offlin": 71, "stai": 71, "constant": 71, "account": 71, "start_step": 71, "neg": 71, "stop_step": 71, "greater": [71, 75], "nor": 71, "enable_oom_observ": 71, "src_modul": 73, "dst_modul": 73, "transfer": 73, "statist": 73, "submodul": [74, 75], "trainabl": 74, "estim": [74, 92, 93, 94], "uniniti": 74, "calcul": [74, 75, 93], "shape": 74, "elaps": [74, 109, 117], "ms": 74, "module_arg": 75, "module_kwarg": 75, "modulesummari": [75, 76, 77], "assign": 75, "tree": [75, 77], "summar": 75, "lazi": 75, "NOT": 75, "todo": 75, "flexibl": [75, 103], "human_readable_num": 76, "summary_t": 76, "tabular": [76, 113], "exact": 76, "1234": 76, "k": 76, "prune": 77, "deeper": 77, "prun": 77, "inplac": 77, "root": 77, "trace_max_entri": 78, "1000000": 78, "attach": 78, "blog": [78, 82], "post": [78, 82], "due": 81, "file_prefix": 82, "prefix": 82, "memory_snapshot": 82, "grad": 83, "necessari": [83, 101], "becaus": [83, 101], "adamw": 83, "lazili": 83, "solut": 83, "ensur": [83, 103, 108, 110], "invalid": [84, 87], "output_devic": 85, "dim": 85, "bucket_cap_mb": 85, "25": 85, "find_unused_paramet": [85, 88], "gradient_as_bucket_view": [85, 88], "static_graph": 85, "comm_stat": 85, "comm_hook": 85, "gradbucket": 85, "futur": 85, "sync_batchnorm": 85, "regist": 85, "sharding_strategi": 86, "shardingstrategi": 86, "cpu_offload": 86, "cpuoffload": 86, "auto_wrap_polici": 86, "backward_prefetch": 86, "backwardprefetch": 86, "backward_pr": 86, "mixed_precis": 86, "mixedprecis": 86, "ignored_modul": 86, "param_init_fn": 86, "sync_module_st": 86, "use_orig_param": 86, "state_dict_config": 86, "statedictconfig": 86, "optim_state_dict_config": 86, "optimstatedictconfig": 86, "noopstrategi": 87, "api": [88, 89, 101], "ddp_modul": 88, "fsdp_modul": 89, "activationcheckpointparam": 90, "noop": 90, "num_epochs_complet": [91, 119], "num_steps_completed_in_epoch": 91, "load_state_dict": 91, "remain": 92, "eval_every_n_step": 93, "eval_every_n_epoch": 93, "couldn": [93, 94], "critic": 95, "info": 98, "stateful_obj": 101, "fsdpoptimizerwrapp": 101, "load_checkpoint": 101, "use_buff": 103, "averaging_method": 103, "ema": 103, "ema_decai": 103, "999": 103, "skip_deepcopi": 103, "use_lit": 103, "streamlin": 103, "give": 103, "compat": 103, "swa_util": 103, "l66": 103, "entail": 103, "exponenti": 103, "decai": 103, "ignor": 103, "somewai": 103, "lit": 103, "adjust": 103, "small": 103, "approach": 103, "nproc": 104, "launchconfig": 104, "pet": 104, "launch_config": 104, "elastic_launch": 104, "interpret": [105, 106], "asan": [105, 107], "tsan": 106, "func": 107, "lower_bound": 108, "upper_bound": 108, "recorded_dur": [108, 110, 111, 112, 114], "size_bound": 108, "lower": 108, "upper": 108, "bound": 108, "smaller": 108, "remov": 108, "action": [108, 112, 114, 115, 116], "cuda_sync": [108, 110, 117], "verbos": [108, 110], "incur": [108, 110], "hit": [108, 110], "accur": [108, 110, 117], "cpu_pg": 109, "propag": 109, "previou": 109, "block": 109, "percentil": [112, 114, 115], "sequenc": [112, 114, 115], "whose": 115, "action_nam": 117, "progress_bar": [118, 120], "tqdm_asyncio": [118, 119, 120], "desc": 119, "far": 119, "he": 119, "reflect": 120, "runtim": [121, 122], "Is": 123}, "objects": {"torchtnt.framework.auto_unit": [[3, 0, 1, "", "AutoPredictUnit"], [3, 0, 1, "", "AutoUnit"]], "torchtnt.framework.auto_unit.AutoPredictUnit": [[3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "predict_step"]], "torchtnt.framework.auto_unit.AutoUnit": [[3, 1, 1, "", "compute_loss"], [3, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [3, 1, 1, "", "eval_step"], [3, 1, 1, "", "get_next_eval_batch"], [3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "get_next_train_batch"], [3, 1, 1, "", "on_eval_step_end"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "on_train_epoch_end"], [3, 1, 1, "", "on_train_step_end"], [3, 1, 1, "", "predict_step"], [3, 1, 1, "", "step_lr_scheduler"], [3, 1, 1, "", "train_step"]], "torchtnt.framework": [[4, 2, 0, "-", "callback"]], "torchtnt.framework.callback": [[4, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[4, 3, 1, "", "name"], [4, 1, 1, "", "on_eval_end"], [4, 1, 1, "", "on_eval_epoch_end"], [4, 1, 1, "", "on_eval_epoch_start"], [4, 1, 1, "", "on_eval_get_next_batch_end"], [4, 1, 1, "", "on_eval_start"], [4, 1, 1, "", "on_eval_step_end"], [4, 1, 1, "", "on_eval_step_start"], [4, 1, 1, "", "on_exception"], [4, 1, 1, "", "on_predict_end"], [4, 1, 1, "", "on_predict_epoch_end"], [4, 1, 1, "", "on_predict_epoch_start"], [4, 1, 1, "", "on_predict_get_next_batch_end"], [4, 1, 1, "", "on_predict_start"], [4, 1, 1, "", "on_predict_step_end"], [4, 1, 1, "", "on_predict_step_start"], [4, 1, 1, "", "on_train_end"], [4, 1, 1, "", "on_train_epoch_end"], [4, 1, 1, "", "on_train_epoch_start"], [4, 1, 1, "", "on_train_get_next_batch_end"], [4, 1, 1, "", "on_train_start"], [4, 1, 1, "", "on_train_step_end"], [4, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[7, 0, 1, "", "BaseCSVWriter"], [8, 0, 1, "", "EarlyStopping"], [9, 0, 1, "", "GarbageCollector"], [10, 0, 1, "", "IterationTimeLogger"], [11, 0, 1, "", "Lambda"], [12, 0, 1, "", "LearningRateMonitor"], [13, 0, 1, "", "MemorySnapshot"], [14, 0, 1, "", "ModuleSummary"], [15, 0, 1, "", "PyTorchProfiler"], [16, 0, 1, "", "SlowRankDetector"], [17, 0, 1, "", "SystemResourcesMonitor"], [18, 0, 1, "", "TQDMProgressBar"], [19, 0, 1, "", "TensorBoardParameterMonitor"], [20, 0, 1, "", "TimeLimitInterrupter"], [21, 0, 1, "", "TorchSnapshotSaver"], [22, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[7, 1, 1, "", "on_exception"], [7, 1, 1, "", "on_predict_end"], [7, 1, 1, "", "on_predict_start"], [7, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.EarlyStopping": [[8, 1, 1, "", "on_train_epoch_end"], [8, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[9, 1, 1, "", "on_eval_end"], [9, 1, 1, "", "on_eval_start"], [9, 1, 1, "", "on_eval_step_end"], [9, 1, 1, "", "on_predict_end"], [9, 1, 1, "", "on_predict_start"], [9, 1, 1, "", "on_predict_step_end"], [9, 1, 1, "", "on_train_end"], [9, 1, 1, "", "on_train_start"], [9, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.IterationTimeLogger": [[10, 1, 1, "", "on_eval_step_end"], [10, 1, 1, "", "on_predict_step_end"], [10, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[12, 1, 1, "", "on_train_epoch_start"], [12, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.MemorySnapshot": [[13, 1, 1, "", "on_eval_step_end"], [13, 1, 1, "", "on_predict_step_end"], [13, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.ModuleSummary": [[14, 1, 1, "", "on_eval_start"], [14, 1, 1, "", "on_predict_start"], [14, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[15, 1, 1, "", "on_eval_end"], [15, 1, 1, "", "on_eval_start"], [15, 1, 1, "", "on_eval_step_end"], [15, 1, 1, "", "on_predict_end"], [15, 1, 1, "", "on_predict_start"], [15, 1, 1, "", "on_predict_step_end"], [15, 1, 1, "", "on_train_end"], [15, 1, 1, "", "on_train_start"], [15, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SlowRankDetector": [[16, 1, 1, "", "on_train_epoch_end"], [16, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[17, 1, 1, "", "on_eval_epoch_start"], [17, 1, 1, "", "on_eval_step_start"], [17, 1, 1, "", "on_predict_epoch_start"], [17, 1, 1, "", "on_predict_step_start"], [17, 1, 1, "", "on_train_epoch_start"], [17, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[18, 1, 1, "", "on_eval_epoch_end"], [18, 1, 1, "", "on_eval_epoch_start"], [18, 1, 1, "", "on_eval_step_end"], [18, 1, 1, "", "on_predict_epoch_end"], [18, 1, 1, "", "on_predict_epoch_start"], [18, 1, 1, "", "on_predict_step_end"], [18, 1, 1, "", "on_train_epoch_end"], [18, 1, 1, "", "on_train_epoch_start"], [18, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[19, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.TimeLimitInterrupter": [[20, 1, 1, "", "on_train_epoch_end"], [20, 1, 1, "", "on_train_start"], [20, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[21, 1, 1, "", "on_exception"], [21, 1, 1, "", "on_train_start"], [21, 1, 1, "", "restore"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[22, 1, 1, "", "on_train_epoch_end"], [22, 1, 1, "", "on_train_start"]], "torchtnt.framework.evaluate": [[5, 4, 1, "", "evaluate"]], "torchtnt.framework.fit": [[6, 4, 1, "", "fit"]], "torchtnt.framework.predict": [[23, 4, 1, "", "predict"]], "torchtnt.framework.state": [[24, 0, 1, "", "PhaseState"], [24, 0, 1, "", "State"]], "torchtnt.framework.state.PhaseState": [[24, 3, 1, "", "dataloader"], [24, 3, 1, "", "evaluate_every_n_epochs"], [24, 3, 1, "", "evaluate_every_n_steps"], [24, 3, 1, "", "iteration_timer"], [24, 3, 1, "", "max_epochs"], [24, 3, 1, "", "max_steps"], [24, 3, 1, "", "max_steps_per_epoch"], [24, 3, 1, "", "step_output"]], "torchtnt.framework.state.State": [[24, 3, 1, "", "active_phase"], [24, 3, 1, "", "entry_point"], [24, 3, 1, "", "eval_state"], [24, 3, 1, "", "predict_state"], [24, 3, 1, "", "should_stop"], [24, 1, 1, "", "stop"], [24, 3, 1, "", "timer"], [24, 3, 1, "", "train_state"]], "torchtnt.framework.train": [[25, 4, 1, "", "train"]], "torchtnt.framework.unit": [[26, 0, 1, "", "EvalUnit"], [26, 0, 1, "", "PredictUnit"], [26, 0, 1, "", "TrainUnit"]], "torchtnt.framework.unit.EvalUnit": [[26, 1, 1, "", "eval_step"], [26, 1, 1, "", "get_next_eval_batch"], [26, 1, 1, "", "on_eval_end"], [26, 1, 1, "", "on_eval_epoch_end"], [26, 1, 1, "", "on_eval_epoch_start"], [26, 1, 1, "", "on_eval_start"]], "torchtnt.framework.unit.PredictUnit": [[26, 1, 1, "", "get_next_predict_batch"], [26, 1, 1, "", "on_predict_end"], [26, 1, 1, "", "on_predict_epoch_end"], [26, 1, 1, "", "on_predict_epoch_start"], [26, 1, 1, "", "on_predict_start"], [26, 1, 1, "", "predict_step"]], "torchtnt.framework.unit.TrainUnit": [[26, 1, 1, "", "get_next_train_batch"], [26, 1, 1, "", "on_train_end"], [26, 1, 1, "", "on_train_epoch_end"], [26, 1, 1, "", "on_train_epoch_start"], [26, 1, 1, "", "on_train_start"], [26, 1, 1, "", "train_step"]], "torchtnt.utils.data": [[29, 0, 1, "", "AbstractRandomDataset"], [30, 0, 1, "", "AllDatasetBatchesIterator"], [31, 0, 1, "", "CudaDataPrefetcher"], [32, 0, 1, "", "InOrderIterator"], [33, 0, 1, "", "MultiDataLoader"], [34, 0, 1, "", "MultiIterator"], [35, 0, 1, "", "RandomizedBatchSamplerIterator"], [36, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.AbstractRandomDataset": [[29, 1, 1, "", "__init__"], [29, 5, 1, "", "size"]], "torchtnt.utils.data.AllDatasetBatchesIterator": [[30, 1, 1, "", "__init__"]], "torchtnt.utils.data.CudaDataPrefetcher": [[31, 1, 1, "", "__init__"]], "torchtnt.utils.data.InOrderIterator": [[32, 1, 1, "", "__init__"]], "torchtnt.utils.data.MultiDataLoader": [[33, 1, 1, "", "__init__"], [33, 5, 1, "", "ignore_empty_data"], [33, 5, 1, "", "individual_dataloaders"], [33, 5, 1, "", "iteration_strategy"], [33, 5, 1, "", "iterator_cls"]], "torchtnt.utils.data.MultiIterator": [[34, 1, 1, "", "__init__"]], "torchtnt.utils.data.RandomizedBatchSamplerIterator": [[35, 1, 1, "", "__init__"]], "torchtnt.utils.data.RoundRobinIterator": [[36, 1, 1, "", "__init__"]], "torchtnt.utils.device": [[37, 4, 1, "", "copy_data_to_device"], [38, 4, 1, "", "get_device_from_env"], [39, 4, 1, "", "get_nvidia_smi_gpu_stats"], [40, 4, 1, "", "get_psutil_cpu_stats"], [41, 4, 1, "", "record_data_in_stream"], [42, 4, 1, "", "set_float32_precision"]], "torchtnt.utils.distributed": [[43, 0, 1, "", "PGWrapper"], [44, 4, 1, "", "all_gather_tensors"], [45, 4, 1, "", "barrier"], [46, 4, 1, "", "destroy_process_group"], [47, 4, 1, "", "get_file_init_method"], [48, 4, 1, "", "get_global_rank"], [49, 4, 1, "", "get_local_rank"], [50, 4, 1, "", "get_process_group_backend_from_device"], [51, 4, 1, "", "get_tcp_init_method"], [52, 4, 1, "", "get_world_size"], [53, 4, 1, "", "rank_zero_fn"], [54, 4, 1, "", "revert_sync_batchnorm"], [55, 4, 1, "", "spawn_multi_process"], [56, 4, 1, "", "sync_bool"]], "torchtnt.utils.distributed.PGWrapper": [[43, 1, 1, "", "__init__"]], "torchtnt.utils.early_stop_checker": [[57, 0, 1, "", "EarlyStopChecker"]], "torchtnt.utils.early_stop_checker.EarlyStopChecker": [[57, 1, 1, "", "__init__"]], "torchtnt.utils.env": [[58, 4, 1, "", "init_from_env"], [59, 4, 1, "", "seed"]], "torchtnt.utils.flops": [[60, 0, 1, "", "FlopTensorDispatchMode"]], "torchtnt.utils.flops.FlopTensorDispatchMode": [[60, 1, 1, "", "__init__"]], "torchtnt.utils.fsspec": [[61, 4, 1, "", "get_filesystem"]], "torchtnt.utils.loggers": [[62, 0, 1, "", "CSVLogger"], [63, 0, 1, "", "FileLogger"], [64, 0, 1, "", "InMemoryLogger"], [65, 0, 1, "", "JSONLogger"], [66, 0, 1, "", "MetricLogger"], [67, 0, 1, "", "StdoutLogger"], [68, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[62, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.FileLogger": [[63, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.InMemoryLogger": [[64, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.JSONLogger": [[65, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.MetricLogger": [[66, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.StdoutLogger": [[67, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.TensorBoardLogger": [[68, 1, 1, "", "__init__"]], "torchtnt.utils.memory": [[69, 0, 1, "", "RSSProfiler"], [70, 4, 1, "", "measure_rss_deltas"]], "torchtnt.utils.memory.RSSProfiler": [[69, 1, 1, "", "__init__"], [69, 5, 1, "", "interval"], [69, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.memory_snapshot_profiler": [[71, 0, 1, "", "MemorySnapshotProfiler"]], "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler": [[71, 1, 1, "", "__init__"]], "torchtnt.utils.misc": [[72, 4, 1, "", "days_to_secs"], [73, 4, 1, "", "transfer_batch_norm_stats"]], "torchtnt.utils.module_summary": [[74, 0, 1, "", "ModuleSummary"], [75, 4, 1, "", "get_module_summary"], [76, 4, 1, "", "get_summary_table"], [77, 4, 1, "", "prune_module_summary"]], "torchtnt.utils.module_summary.ModuleSummary": [[74, 1, 1, "", "__init__"]], "torchtnt.utils.oom": [[78, 4, 1, "", "attach_oom_observer"], [79, 4, 1, "", "is_out_of_cpu_memory"], [80, 4, 1, "", "is_out_of_cuda_memory"], [81, 4, 1, "", "is_out_of_memory_error"], [82, 4, 1, "", "log_memory_snapshot"]], "torchtnt.utils.optimizer": [[83, 4, 1, "", "init_optim_state"]], "torchtnt.utils.precision": [[84, 4, 1, "", "convert_precision_str_to_dtype"]], "torchtnt.utils.prepare_module": [[85, 0, 1, "", "DDPStrategy"], [86, 0, 1, "", "FSDPStrategy"], [87, 4, 1, "", "convert_str_to_strategy"], [88, 4, 1, "", "prepare_ddp"], [89, 4, 1, "", "prepare_fsdp"], [90, 4, 1, "", "prepare_module"]], "torchtnt.utils.prepare_module.DDPStrategy": [[85, 1, 1, "", "__init__"]], "torchtnt.utils.prepare_module.FSDPStrategy": [[86, 1, 1, "", "__init__"]], "torchtnt.utils.progress": [[91, 0, 1, "", "Progress"], [92, 4, 1, "", "estimated_steps_in_epoch"], [93, 4, 1, "", "estimated_steps_in_fit"], [94, 4, 1, "", "estimated_steps_in_loop"]], "torchtnt.utils.progress.Progress": [[91, 1, 1, "", "__init__"]], "torchtnt.utils.rank_zero_log": [[95, 4, 1, "", "rank_zero_critical"], [96, 4, 1, "", "rank_zero_debug"], [97, 4, 1, "", "rank_zero_error"], [98, 4, 1, "", "rank_zero_info"], [99, 4, 1, "", "rank_zero_print"], [100, 4, 1, "", "rank_zero_warn"]], "torchtnt.utils.stateful": [[101, 0, 1, "", "MultiStateful"], [102, 0, 1, "", "Stateful"]], "torchtnt.utils.stateful.MultiStateful": [[101, 1, 1, "", "__init__"]], "torchtnt.utils.stateful.Stateful": [[102, 1, 1, "", "__init__"]], "torchtnt.utils.swa": [[103, 0, 1, "", "AveragedModel"]], "torchtnt.utils.swa.AveragedModel": [[103, 1, 1, "", "__init__"]], "torchtnt.utils.test_utils": [[104, 4, 1, "", "get_pet_launch_config"], [105, 4, 1, "", "is_asan"], [106, 4, 1, "", "is_tsan"], [107, 4, 1, "", "skip_if_asan"]], "torchtnt.utils.timer": [[108, 0, 1, "", "BoundedTimer"], [109, 0, 1, "", "FullSyncPeriodicTimer"], [110, 0, 1, "", "Timer"], [111, 0, 1, "", "TimerProtocol"], [112, 4, 1, "", "get_durations_histogram"], [113, 4, 1, "", "get_recorded_durations_table"], [114, 4, 1, "", "get_synced_durations_histogram"], [115, 4, 1, "", "get_synced_timer_histogram"], [116, 4, 1, "", "get_timer_summary"], [117, 4, 1, "", "log_elapsed_time"]], "torchtnt.utils.timer.BoundedTimer": [[108, 1, 1, "", "__init__"]], "torchtnt.utils.timer.FullSyncPeriodicTimer": [[109, 1, 1, "", "__init__"]], "torchtnt.utils.timer.Timer": [[110, 1, 1, "", "__init__"]], "torchtnt.utils.timer.TimerProtocol": [[111, 1, 1, "", "__init__"]], "torchtnt.utils.tqdm": [[118, 4, 1, "", "close_progress_bar"], [119, 4, 1, "", "create_progress_bar"], [120, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.version": [[121, 4, 1, "", "get_python_version"], [122, 4, 1, "", "get_torch_version"], [123, 4, 1, "", "is_windows"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"checkpoint": 0, "fulli": [0, 1], "shard": [0, 1], "data": [0, 1, 29, 30, 31, 32, 33, 34, 35, 36, 124], "parallel": [0, 1], "finetun": 0, "best": 0, "model": [0, 28], "metric": 0, "distribut": [1, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 124], "train": [1, 2, 25, 28], "exampl": [2, 27], "trainunit": [2, 26], "autounit": [2, 3], "torchdata": 2, "mnist": 2, "mingpt": 2, "torchrec": 2, "callback": [4, 28], "built": 4, "evalu": 5, "entri": [5, 6, 23, 25], "point": [5, 6, 23, 25], "fit": 6, "basecsvwrit": 7, "earlystop": 8, "garbagecollector": 9, "iterationtimelogg": 10, "lambda": 11, "learningratemonitor": 12, "memorysnapshot": 13, "modulesummari": [14, 74], "pytorchprofil": 15, "slowrankdetector": 16, "systemresourcesmonitor": 17, "tqdmprogressbar": 18, "tensorboardparametermonitor": 19, "timelimitinterrupt": 20, "torchsnapshotsav": 21, "trainprogressmonitor": 22, "predict": 23, "state": [24, 101, 102, 124], "phasest": 24, "unit": 26, "evalunit": 26, "predictunit": 26, "combin": 26, "multipl": 26, "welcom": 27, "torchtnt": [27, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123], "document": 27, "instal": 27, "overview": [27, 28], "core": [27, 28], "concept": 27, "framework": [27, 28], "util": [27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124], "function": 28, "api": 28, "organ": 28, "your": 28, "code": 28, "abstractrandomdataset": 29, "alldatasetbatchesiter": 30, "cudadataprefetch": 31, "inorderiter": 32, "multidataload": 33, "multiiter": 34, "randomizedbatchsampleriter": 35, "roundrobiniter": 36, "devic": [37, 38, 39, 40, 41, 42, 124], "copy_data_to_devic": 37, "get_device_from_env": 38, "get_nvidia_smi_gpu_stat": 39, "get_psutil_cpu_stat": 40, "record_data_in_stream": 41, "set_float32_precis": 42, "pgwrapper": 43, "all_gather_tensor": 44, "barrier": 45, "destroy_process_group": 46, "get_file_init_method": 47, "get_global_rank": 48, "get_local_rank": 49, "get_process_group_backend_from_devic": 50, "get_tcp_init_method": 51, "get_world_s": 52, "rank_zero_fn": 53, "revert_sync_batchnorm": 54, "spawn_multi_process": 55, "sync_bool": 56, "early_stop_check": 57, "earlystopcheck": 57, "env": [58, 59], "init_from_env": 58, "seed": 59, "flop": [60, 124], "floptensordispatchmod": 60, "fsspec": 61, "get_filesystem": 61, "logger": [62, 63, 64, 65, 66, 67, 68, 124], "csvlogger": 62, "filelogg": 63, "inmemorylogg": 64, "jsonlogg": 65, "metriclogg": 66, "stdoutlogg": 67, "tensorboardlogg": 68, "memori": [69, 70, 124], "rssprofil": 69, "measure_rss_delta": 70, "memory_snapshot_profil": 71, "memorysnapshotprofil": [71, 124], "misc": [72, 73, 124], "days_to_sec": 72, "transfer_batch_norm_stat": 73, "module_summari": [74, 75, 76, 77], "get_module_summari": 75, "get_summary_t": 76, "prune_module_summari": 77, "oom": [78, 79, 80, 81, 82, 124], "attach_oom_observ": 78, "is_out_of_cpu_memori": 79, "is_out_of_cuda_memori": 80, "is_out_of_memory_error": 81, "log_memory_snapshot": 82, "optim": [83, 124], "init_optim_st": 83, "precis": [84, 124], "convert_precision_str_to_dtyp": 84, "prepare_modul": [85, 86, 87, 88, 89, 90], "ddpstrategi": 85, "fsdpstrategi": 86, "convert_str_to_strategi": 87, "prepare_ddp": 88, "prepare_fsdp": 89, "progress": [91, 92, 93, 94, 124], "estimated_steps_in_epoch": 92, "estimated_steps_in_fit": 93, "estimated_steps_in_loop": 94, "rank_zero_log": [95, 96, 97, 98, 99, 100], "rank_zero_crit": 95, "rank_zero_debug": 96, "rank_zero_error": 97, "rank_zero_info": 98, "rank_zero_print": 99, "rank_zero_warn": 100, "multist": 101, "swa": [103, 124], "averagedmodel": 103, "test_util": [104, 105, 106, 107], "get_pet_launch_config": 104, "is_asan": 105, "is_tsan": 106, "skip_if_asan": 107, "timer": [108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 124], "boundedtim": 108, "fullsyncperiodictim": 109, "timerprotocol": 111, "get_durations_histogram": 112, "get_recorded_durations_t": 113, "get_synced_durations_histogram": 114, "get_synced_timer_histogram": 115, "get_timer_summari": 116, "log_elapsed_tim": 117, "tqdm": [118, 119, 120, 124], "close_progress_bar": 118, "create_progress_bar": 119, "update_progress_bar": 120, "version": [121, 122, 123, 124], "get_python_vers": 121, "get_torch_vers": 122, "is_window": 123, "earli": 124, "stop": 124, "checker": 124, "environ": 124, "filesystem": 124, "spec": 124, "modul": 124, "summari": 124, "prepar": 124, "rank": 124, "zero": 124, "log": 124, "test": 124}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})