Search.setIndex({"docnames": ["checkpointing", "distributed", "examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.EarlyStopping", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.ProgressReporter", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SlowRankDetector", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.ThroughputLogger", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter", "framework/generated/torchtnt.framework.callbacks.TimeWaitForBatchLogger", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "overview", "utils/generated/torchtnt.utils.data.AbstractRandomDataset", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.device.copy_data_to_device", "utils/generated/torchtnt.utils.device.get_device_from_env", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats", "utils/generated/torchtnt.utils.device.record_data_in_stream", "utils/generated/torchtnt.utils.device.set_float32_precision", "utils/generated/torchtnt.utils.distributed.PGWrapper", "utils/generated/torchtnt.utils.distributed.all_gather_tensors", "utils/generated/torchtnt.utils.distributed.barrier", "utils/generated/torchtnt.utils.distributed.destroy_process_group", "utils/generated/torchtnt.utils.distributed.get_file_init_method", "utils/generated/torchtnt.utils.distributed.get_global_rank", "utils/generated/torchtnt.utils.distributed.get_local_rank", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method", "utils/generated/torchtnt.utils.distributed.get_world_size", "utils/generated/torchtnt.utils.distributed.rank_zero_fn", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm", "utils/generated/torchtnt.utils.distributed.spawn_multi_process", "utils/generated/torchtnt.utils.distributed.sync_bool", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker", "utils/generated/torchtnt.utils.env.init_from_env", "utils/generated/torchtnt.utils.env.seed", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode", "utils/generated/torchtnt.utils.fsspec.get_filesystem", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.FileLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.MetricLogger", "utils/generated/torchtnt.utils.loggers.StdoutLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/generated/torchtnt.utils.memory.RSSProfiler", "utils/generated/torchtnt.utils.memory.measure_rss_deltas", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "utils/generated/torchtnt.utils.misc.days_to_secs", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats", "utils/generated/torchtnt.utils.module_summary.ModuleSummary", "utils/generated/torchtnt.utils.module_summary.get_module_summary", "utils/generated/torchtnt.utils.module_summary.get_summary_table", "utils/generated/torchtnt.utils.module_summary.prune_module_summary", "utils/generated/torchtnt.utils.oom.attach_oom_observer", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error", "utils/generated/torchtnt.utils.oom.log_memory_snapshot", "utils/generated/torchtnt.utils.optimizer.init_optim_state", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp", "utils/generated/torchtnt.utils.prepare_module.prepare_module", "utils/generated/torchtnt.utils.progress.Progress", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn", "utils/generated/torchtnt.utils.stateful.MultiStateful", "utils/generated/torchtnt.utils.stateful.Stateful", "utils/generated/torchtnt.utils.swa.AveragedModel", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config", "utils/generated/torchtnt.utils.test_utils.is_asan", "utils/generated/torchtnt.utils.test_utils.is_tsan", "utils/generated/torchtnt.utils.test_utils.skip_if_asan", "utils/generated/torchtnt.utils.timer.BoundedTimer", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer", "utils/generated/torchtnt.utils.timer.Timer", "utils/generated/torchtnt.utils.timer.TimerProtocol", "utils/generated/torchtnt.utils.timer.get_durations_histogram", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram", "utils/generated/torchtnt.utils.timer.get_timer_summary", "utils/generated/torchtnt.utils.timer.log_elapsed_time", "utils/generated/torchtnt.utils.tqdm.close_progress_bar", "utils/generated/torchtnt.utils.tqdm.create_progress_bar", "utils/generated/torchtnt.utils.tqdm.update_progress_bar", "utils/generated/torchtnt.utils.version.get_python_version", "utils/generated/torchtnt.utils.version.get_torch_version", "utils/generated/torchtnt.utils.version.is_windows", "utils/utils"], "filenames": ["checkpointing.rst", "distributed.rst", "examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.EarlyStopping.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.ProgressReporter.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SlowRankDetector.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.ThroughputLogger.rst", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter.rst", "framework/generated/torchtnt.framework.callbacks.TimeWaitForBatchLogger.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "overview.rst", "utils/generated/torchtnt.utils.data.AbstractRandomDataset.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.device.copy_data_to_device.rst", "utils/generated/torchtnt.utils.device.get_device_from_env.rst", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats.rst", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats.rst", "utils/generated/torchtnt.utils.device.record_data_in_stream.rst", "utils/generated/torchtnt.utils.device.set_float32_precision.rst", "utils/generated/torchtnt.utils.distributed.PGWrapper.rst", "utils/generated/torchtnt.utils.distributed.all_gather_tensors.rst", "utils/generated/torchtnt.utils.distributed.barrier.rst", "utils/generated/torchtnt.utils.distributed.destroy_process_group.rst", "utils/generated/torchtnt.utils.distributed.get_file_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_global_rank.rst", "utils/generated/torchtnt.utils.distributed.get_local_rank.rst", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device.rst", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_world_size.rst", "utils/generated/torchtnt.utils.distributed.rank_zero_fn.rst", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm.rst", "utils/generated/torchtnt.utils.distributed.spawn_multi_process.rst", "utils/generated/torchtnt.utils.distributed.sync_bool.rst", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker.rst", "utils/generated/torchtnt.utils.env.init_from_env.rst", "utils/generated/torchtnt.utils.env.seed.rst", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode.rst", "utils/generated/torchtnt.utils.fsspec.get_filesystem.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.FileLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.MetricLogger.rst", "utils/generated/torchtnt.utils.loggers.StdoutLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/generated/torchtnt.utils.memory.RSSProfiler.rst", "utils/generated/torchtnt.utils.memory.measure_rss_deltas.rst", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler.rst", "utils/generated/torchtnt.utils.misc.days_to_secs.rst", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats.rst", "utils/generated/torchtnt.utils.module_summary.ModuleSummary.rst", "utils/generated/torchtnt.utils.module_summary.get_module_summary.rst", "utils/generated/torchtnt.utils.module_summary.get_summary_table.rst", "utils/generated/torchtnt.utils.module_summary.prune_module_summary.rst", "utils/generated/torchtnt.utils.oom.attach_oom_observer.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error.rst", "utils/generated/torchtnt.utils.oom.log_memory_snapshot.rst", "utils/generated/torchtnt.utils.optimizer.init_optim_state.rst", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype.rst", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_module.rst", "utils/generated/torchtnt.utils.progress.Progress.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn.rst", "utils/generated/torchtnt.utils.stateful.MultiStateful.rst", "utils/generated/torchtnt.utils.stateful.Stateful.rst", "utils/generated/torchtnt.utils.swa.AveragedModel.rst", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config.rst", "utils/generated/torchtnt.utils.test_utils.is_asan.rst", "utils/generated/torchtnt.utils.test_utils.is_tsan.rst", "utils/generated/torchtnt.utils.test_utils.skip_if_asan.rst", "utils/generated/torchtnt.utils.timer.BoundedTimer.rst", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer.rst", "utils/generated/torchtnt.utils.timer.Timer.rst", "utils/generated/torchtnt.utils.timer.TimerProtocol.rst", "utils/generated/torchtnt.utils.timer.get_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table.rst", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram.rst", "utils/generated/torchtnt.utils.timer.get_timer_summary.rst", "utils/generated/torchtnt.utils.timer.log_elapsed_time.rst", "utils/generated/torchtnt.utils.tqdm.close_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.create_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.update_progress_bar.rst", "utils/generated/torchtnt.utils.version.get_python_version.rst", "utils/generated/torchtnt.utils.version.get_torch_version.rst", "utils/generated/torchtnt.utils.version.is_windows.rst", "utils/utils.rst"], "titles": ["Checkpointing", "Distributed training", "Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "EarlyStopping", "GarbageCollector", "IterationTimeLogger", "Lambda", "LearningRateMonitor", "MemorySnapshot", "ModuleSummary", "ProgressReporter", "PyTorchProfiler", "SlowRankDetector", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "ThroughputLogger", "TimeLimitInterrupter", "TimeWaitForBatchLogger", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Overview", "torchtnt.utils.data.AbstractRandomDataset", "torchtnt.utils.data.AllDatasetBatchesIterator", "torchtnt.utils.data.CudaDataPrefetcher", "torchtnt.utils.data.InOrderIterator", "torchtnt.utils.data.MultiDataLoader", "torchtnt.utils.data.MultiIterator", "torchtnt.utils.data.RandomizedBatchSamplerIterator", "torchtnt.utils.data.RoundRobinIterator", "torchtnt.utils.device.copy_data_to_device", "torchtnt.utils.device.get_device_from_env", "torchtnt.utils.device.get_nvidia_smi_gpu_stats", "torchtnt.utils.device.get_psutil_cpu_stats", "torchtnt.utils.device.record_data_in_stream", "torchtnt.utils.device.set_float32_precision", "torchtnt.utils.distributed.PGWrapper", "torchtnt.utils.distributed.all_gather_tensors", "torchtnt.utils.distributed.barrier", "torchtnt.utils.distributed.destroy_process_group", "torchtnt.utils.distributed.get_file_init_method", "torchtnt.utils.distributed.get_global_rank", "torchtnt.utils.distributed.get_local_rank", "torchtnt.utils.distributed.get_process_group_backend_from_device", "torchtnt.utils.distributed.get_tcp_init_method", "torchtnt.utils.distributed.get_world_size", "torchtnt.utils.distributed.rank_zero_fn", "torchtnt.utils.distributed.revert_sync_batchnorm", "torchtnt.utils.distributed.spawn_multi_process", "torchtnt.utils.distributed.sync_bool", "torchtnt.utils.early_stop_checker.EarlyStopChecker", "torchtnt.utils.env.init_from_env", "torchtnt.utils.env.seed", "torchtnt.utils.flops.FlopTensorDispatchMode", "torchtnt.utils.fsspec.get_filesystem", "torchtnt.utils.loggers.CSVLogger", "torchtnt.utils.loggers.FileLogger", "torchtnt.utils.loggers.InMemoryLogger", "torchtnt.utils.loggers.JSONLogger", "torchtnt.utils.loggers.MetricLogger", "torchtnt.utils.loggers.StdoutLogger", "torchtnt.utils.loggers.TensorBoardLogger", "torchtnt.utils.memory.RSSProfiler", "torchtnt.utils.memory.measure_rss_deltas", "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "torchtnt.utils.misc.days_to_secs", "torchtnt.utils.misc.transfer_batch_norm_stats", "torchtnt.utils.module_summary.ModuleSummary", "torchtnt.utils.module_summary.get_module_summary", "torchtnt.utils.module_summary.get_summary_table", "torchtnt.utils.module_summary.prune_module_summary", "torchtnt.utils.oom.attach_oom_observer", "torchtnt.utils.oom.is_out_of_cpu_memory", "torchtnt.utils.oom.is_out_of_cuda_memory", "torchtnt.utils.oom.is_out_of_memory_error", "torchtnt.utils.oom.log_memory_snapshot", "torchtnt.utils.optimizer.init_optim_state", "torchtnt.utils.precision.convert_precision_str_to_dtype", "torchtnt.utils.prepare_module.DDPStrategy", "torchtnt.utils.prepare_module.FSDPStrategy", "torchtnt.utils.prepare_module.convert_str_to_strategy", "torchtnt.utils.prepare_module.prepare_ddp", "torchtnt.utils.prepare_module.prepare_fsdp", "torchtnt.utils.prepare_module.prepare_module", "torchtnt.utils.progress.Progress", "torchtnt.utils.progress.estimated_steps_in_epoch", "torchtnt.utils.progress.estimated_steps_in_fit", "torchtnt.utils.progress.estimated_steps_in_loop", "torchtnt.utils.rank_zero_log.rank_zero_critical", "torchtnt.utils.rank_zero_log.rank_zero_debug", "torchtnt.utils.rank_zero_log.rank_zero_error", "torchtnt.utils.rank_zero_log.rank_zero_info", "torchtnt.utils.rank_zero_log.rank_zero_print", "torchtnt.utils.rank_zero_log.rank_zero_warn", "torchtnt.utils.stateful.MultiStateful", "torchtnt.utils.stateful.Stateful", "torchtnt.utils.swa.AveragedModel", "torchtnt.utils.test_utils.get_pet_launch_config", "torchtnt.utils.test_utils.is_asan", "torchtnt.utils.test_utils.is_tsan", "torchtnt.utils.test_utils.skip_if_asan", "torchtnt.utils.timer.BoundedTimer", "torchtnt.utils.timer.FullSyncPeriodicTimer", "torchtnt.utils.timer.Timer", "torchtnt.utils.timer.TimerProtocol", "torchtnt.utils.timer.get_durations_histogram", "torchtnt.utils.timer.get_recorded_durations_table", "torchtnt.utils.timer.get_synced_durations_histogram", "torchtnt.utils.timer.get_synced_timer_histogram", "torchtnt.utils.timer.get_timer_summary", "torchtnt.utils.timer.log_elapsed_time", "torchtnt.utils.tqdm.close_progress_bar", "torchtnt.utils.tqdm.create_progress_bar", "torchtnt.utils.tqdm.update_progress_bar", "torchtnt.utils.version.get_python_version", "torchtnt.utils.version.get_torch_version", "torchtnt.utils.version.is_windows", "Utils"], "terms": {"torchtnt": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31], "offer": [0, 1, 3, 4, 24, 29, 31], "via": [0, 39], "torchsnapshotsav": 0, "which": [0, 1, 3, 4, 5, 6, 10, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 34, 36, 40, 44, 45, 57, 59, 60, 73, 74, 91, 92, 93, 111, 113, 119], "us": [0, 1, 2, 3, 4, 5, 6, 8, 13, 14, 15, 16, 17, 21, 22, 24, 26, 27, 28, 29, 31, 34, 38, 43, 44, 45, 46, 48, 50, 51, 52, 54, 55, 56, 58, 59, 61, 62, 64, 71, 78, 86, 90, 93, 106, 117, 118, 122, 127], "torchsnapshot": [0, 24], "under": [0, 24, 29], "hood": 0, "modul": [0, 1, 3, 5, 6, 14, 20, 26, 28, 29, 30, 31, 57, 62, 63, 76, 77, 78, 80, 89, 91, 92, 93, 104, 106], "nn": [0, 1, 3, 29, 31, 57, 91, 92, 104], "linear": [0, 1, 31, 57, 91, 92], "input_dim": [0, 1], "1": [0, 1, 6, 8, 9, 10, 17, 19, 21, 22, 23, 31, 33, 34, 35, 38, 39, 55, 56, 59, 60, 62, 63, 70, 78, 79, 80, 91, 92, 125], "unit": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 30, 31], "myunit": [0, 11, 29, 31], "tss": 0, "dirpath": [0, 24], "your_dirpath_her": 0, "save_every_n_train_step": [0, 24], "100": [0, 17, 32, 57, 65, 68, 115, 117, 118], "save_every_n_epoch": [0, 24], "2": [0, 3, 22, 33, 34, 35, 38, 39, 59, 62, 70, 79], "load": [0, 1, 24, 34, 86, 105], "latest": [0, 30], "exist": [0, 24, 86], "latest_checkpoint_dir": 0, "restore_from_latest": 0, "train_dataload": [0, 4, 6, 24, 28, 31, 96], "dataload": [0, 3, 5, 6, 11, 24, 26, 27, 28, 29, 31, 33, 34, 35, 36, 37, 38, 39, 74, 95, 97, 122], "train": [0, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 71, 74, 96, 107, 112, 127], "callback": [0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 30], "There": [0, 24, 31], "built": [0, 31], "support": [0, 3, 33, 35, 36, 37, 39, 41, 59, 78], "save": [0, 7, 13, 24, 74, 81, 85, 104, 105], "distribut": [0, 8, 9, 19, 24, 30, 31, 41, 61, 71, 90, 107], "ddp": [0, 1, 3, 31, 88, 91, 93], "fsdp": [0, 1, 3, 24, 31, 92, 93, 106], "The": [0, 1, 2, 3, 5, 6, 7, 8, 9, 14, 21, 22, 24, 26, 28, 29, 31, 32, 40, 44, 45, 50, 57, 59, 61, 63, 70, 72, 73, 74, 78, 80, 81, 85, 106, 107, 111, 115, 117, 118, 122], "state": [0, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 30, 31, 56, 86], "dict": [0, 14, 21, 24, 33, 35, 36, 42, 43, 72, 86, 104, 115, 116, 117, 118], "type": [0, 14, 21, 24, 29, 31, 32, 36, 42, 43, 47, 56, 61, 77], "can": [0, 1, 2, 3, 4, 5, 6, 9, 21, 22, 24, 26, 27, 28, 29, 30, 31, 34, 35, 37, 38, 39, 56, 71, 74, 127], "specifi": [0, 13, 19, 22, 29, 31, 59, 74, 90, 106, 122], "fsdpstrategi": [0, 1, 3, 90, 92], "s": [0, 2, 3, 5, 6, 9, 15, 24, 26, 28, 29, 36, 59, 61, 78, 118], "state_dict_typ": [0, 89], "argument": [0, 1, 3, 5, 6, 26, 28, 40, 71, 78, 106], "like": [0, 1, 3, 17, 24, 37, 44, 86, 106], "so": [0, 1, 3, 30, 70, 74, 122], "fsdp_strategi": [0, 1], "set": [0, 1, 5, 6, 18, 24, 26, 28, 33, 38, 41, 45, 52, 60, 61, 62, 70, 72, 73, 74, 79, 85, 91, 92, 93, 111, 113, 120], "sharded_state_dict": 0, "prepare_fsdp": [0, 1], "strategi": [0, 1, 3, 31, 39, 88, 89, 90, 91, 92, 93], "Or": 0, "you": [0, 1, 3, 17, 21, 24, 29, 30, 78], "manual": [0, 31], "thi": [0, 1, 3, 4, 6, 7, 8, 9, 13, 15, 17, 21, 22, 24, 25, 29, 32, 33, 34, 35, 36, 38, 39, 41, 44, 47, 48, 54, 56, 57, 59, 60, 61, 62, 70, 71, 77, 81, 85, 86, 93, 106, 111], "set_state_dict_typ": [0, 24], "statedicttyp": [0, 89], "when": [0, 1, 2, 3, 4, 7, 11, 13, 14, 22, 24, 25, 27, 33, 34, 44, 48, 60, 64, 72, 73, 81, 111], "your": [0, 1, 4, 13, 21, 29], "pass": [0, 1, 3, 4, 15, 17, 21, 24, 29, 31, 36, 40, 65, 71, 78, 87, 90, 106, 115], "restoreopt": [0, 24], "avoid": [0, 44, 62, 112], "optim": [0, 3, 5, 6, 12, 26, 28, 29, 30, 31, 104, 106], "learn": [0, 3, 12, 29], "rate": [0, 3, 12, 19, 29], "schedul": [0, 3, 12, 29], "your_unit": 0, "restore_opt": [0, 24], "restore_optim": 0, "fals": [0, 1, 24, 36, 65, 68, 74, 79, 88, 89, 93, 106, 113], "restore_lr_schedul": 0, "sometim": 0, "mai": [0, 5, 6, 24, 26, 28, 47, 86, 104], "help": [0, 1, 25], "keep": [0, 14, 24, 74, 80], "track": [0, 5, 6, 12, 22, 26, 28, 74, 94], "how": [0, 2, 3, 6, 22, 29, 33, 35, 36, 37, 38, 39], "perform": [0, 3, 5, 6, 9, 24, 26, 28, 29, 111, 113], "done": [0, 5, 6, 26, 28, 33, 39, 112], "bestcheckpointconfig": [0, 24], "param": [0, 3, 24, 88, 93, 106], "best_checkpoint_config": [0, 24], "monitored_metr": 0, "train_loss": [0, 31], "mode": [0, 5, 6, 26, 28, 60, 110], "min": [0, 60], "By": [0, 7, 9, 24, 35, 38, 44], "monitor": [0, 8, 24, 31, 60], "expect": [0, 1], "trainunit": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 31], "have": [0, 3, 24, 29, 31, 47, 57, 70, 104], "attribut": [0, 8, 24, 32, 60, 65, 66, 67, 68, 71, 77, 88, 89, 94, 106, 111, 113, 114], "time": [0, 5, 6, 9, 10, 17, 21, 22, 23, 24, 26, 27, 28, 65, 75, 77, 86, 111, 112, 113, 114, 116, 120], "cast": 0, "valu": [0, 3, 8, 21, 24, 33, 35, 36, 37, 38, 39, 42, 43, 47, 58, 59, 61, 62, 70, 72, 78, 97, 115, 117, 118], "float": [0, 8, 24, 31, 42, 43, 59, 60, 95, 106, 115, 116, 117, 118], "append": [0, 73, 85], "path": [0, 7, 24, 64, 65, 66, 68, 71], "name": [0, 4, 7, 14, 21, 24, 33, 35, 36, 37, 38, 39, 65, 70, 72, 77, 115, 117, 118, 120], "comput": [0, 3, 31, 34, 115, 117, 118], "kept": [0, 24, 111], "up": [0, 9, 27, 93], "date": 0, "appropri": [0, 24, 31, 41, 64], "user": [0, 1, 3, 13, 16, 21, 24, 27, 29, 31, 34, 74, 106], "later": 0, "restore_from_best": 0, "metric_nam": 0, "If": [0, 1, 3, 8, 14, 15, 17, 22, 24, 29, 30, 41, 42, 48, 50, 54, 57, 59, 60, 61, 62, 71, 74, 78, 80, 85, 96, 106, 111, 113, 115, 117, 118, 119, 120], "d": [0, 57], "valid": [0, 24], "sai": 0, "loss": [0, 3, 29, 31, 70], "after": [0, 3, 4, 6, 7, 8, 9, 10, 13, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 27, 29, 31, 38, 60, 70, 71, 86, 111, 113], "each": [0, 3, 7, 9, 11, 12, 15, 17, 21, 24, 27, 29, 32, 38, 47, 70, 115, 117, 118], "eval": [0, 3, 4, 5, 6, 9, 10, 11, 13, 15, 16, 18, 19, 21, 23, 24, 26, 27, 29, 31, 96], "epoch": [0, 3, 4, 5, 6, 8, 11, 12, 15, 17, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 31, 95, 96, 97, 122], "dure": [0, 3, 4, 5, 6, 7, 11, 13, 24, 26, 27, 28, 94], "fit": [0, 3, 4, 21, 24, 27, 29, 30, 31, 96], "save_every_n_eval_epoch": [0, 24], "flag": [0, 3, 24, 93], "instead": [0, 24, 51, 55, 57], "eval_loss": 0, "And": 0, "onli": [0, 3, 8, 19, 21, 24, 27, 41, 44, 56, 59, 61, 65, 66, 68, 71, 78, 81, 85, 86, 98, 99, 100, 101, 102, 103, 104, 106], "top": [0, 24, 30, 31], "three": [0, 29, 31, 33], "keep_last_n_checkpoint": [0, 24], "3": [0, 27, 33, 35, 38, 39, 59, 63, 124], "core": [1, 3, 29], "tnt": [1, 2, 30, 31], "framework": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 32, 127], "make": [1, 9, 13, 17, 30, 59, 70], "assumpt": 1, "about": [1, 3, 27, 29, 44], "devic": [1, 3, 17, 30, 31, 34, 53, 57, 61, 81, 85, 88, 91, 92, 93, 106], "handl": [1, 3, 31, 64], "configur": [1, 3, 9, 24], "own": [1, 4], "As": [1, 9, 21, 44], "conveni": [1, 3, 9, 29, 61, 94], "autounit": [1, 30, 31], "who": [1, 3, 31], "prefer": [1, 31], "automat": [1, 3, 9, 31, 54, 106], "provid": [1, 7, 22, 24, 32, 35, 36, 37, 38, 59, 85], "checkpoint": [1, 3, 4, 24, 30, 31, 86, 93, 94, 105], "model": [1, 2, 3, 4, 9, 13, 24, 29, 61, 63, 74, 76, 106], "ar": [1, 3, 4, 17, 21, 22, 24, 29, 30, 31, 33, 35, 36, 37, 38, 39, 47, 59, 65, 73, 74, 78, 80, 81, 85, 86, 106, 110, 115, 117, 118, 127], "evalunit": [1, 3, 4, 5, 6, 7, 9, 10, 11, 13, 14, 15, 16, 18, 19, 21, 23, 24, 31], "predictunit": [1, 3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 18, 19, 21, 23, 24, 26, 31], "interfac": [1, 3, 7, 29, 31, 105], "initi": [1, 3, 13, 19, 24, 46, 48, 49, 50, 51, 54, 55, 59, 61, 63, 71, 72, 73, 86, 107], "cuda": [1, 5, 6, 18, 26, 28, 31, 34, 41, 44, 57, 81, 83, 85, 91, 92, 111, 113, 120], "applic": [1, 9, 24, 61], "along": [1, 115, 117, 118], "global": [1, 22, 48, 49, 50, 54, 56, 61, 62, 117, 118], "process": [1, 7, 9, 17, 21, 22, 24, 43, 46, 47, 48, 49, 53, 54, 58, 59, 61, 71, 107, 112, 117, 118], "group": [1, 12, 17, 22, 24, 47, 48, 49, 53, 59, 61, 71, 117, 118], "from": [1, 3, 4, 5, 6, 11, 14, 17, 24, 26, 28, 29, 30, 31, 33, 35, 37, 38, 42, 44, 47, 53, 56, 61, 63, 67, 70, 71, 75, 86, 98, 99, 100, 101, 102, 103, 107, 112, 115, 117, 122], "torch": [1, 3, 5, 6, 10, 16, 20, 21, 23, 24, 26, 28, 29, 31, 33, 34, 35, 38, 39, 40, 41, 42, 44, 45, 48, 51, 55, 57, 59, 61, 62, 63, 87, 91, 92, 93, 106, 107, 111, 113], "we": [1, 4, 9, 21, 31, 34, 44, 78, 104, 110], "function": [1, 3, 4, 11, 14, 29, 36, 37, 40, 41, 47, 48, 50, 53, 54, 56, 57, 58, 59, 61, 62, 78, 81, 86, 102, 107, 116], "init_from_env": 1, "work": [1, 47, 86], "torchelast": 1, "should": [1, 3, 4, 6, 7, 22, 24, 29, 32, 34, 40, 56, 57, 59, 60, 71, 111, 115, 117, 118], "invok": [1, 31, 48], "begin": [1, 25, 61], "script": [1, 13, 61], "simpli": 1, "wrap": [1, 48, 56, 91, 92, 106], "around": [1, 30, 31, 46], "move": [1, 10, 31, 34, 35, 91, 92, 93], "device_id": 1, "index": [1, 37, 41], "distributeddataparallel": [1, 88, 91], "also": [1, 3, 17, 24, 30, 31, 36, 37, 41], "prepare_ddp": 1, "assist": 1, "either": [1, 3, 10, 12, 18, 20, 22, 23, 25, 29], "string": [1, 3, 7, 22, 79, 87, 90, 93], "my_auto_unit": 1, "myautounit": 1, "dataclass": [1, 3, 33, 35, 36, 37, 38, 39, 88, 89, 90], "ddpstrategi": [1, 90, 91], "want": [1, 3, 14, 24, 29, 31], "custom": [1, 3, 24, 29, 32, 35, 106], "ddp_strategi": 1, "broadcast_buff": [1, 88], "check_reduct": [1, 88], "true": [1, 3, 24, 59, 60, 65, 66, 68, 74, 79, 82, 83, 84, 88, 89, 91, 92, 93, 106, 111, 113, 120], "one": [1, 3, 7, 8, 21, 22, 29, 35, 39, 49, 57, 60, 61, 93, 104], "more": [1, 2, 3, 21, 24, 31, 34, 36, 37, 45, 48, 50, 54, 57, 61, 62, 78, 81, 85, 106], "fullyshardeddataparallel": [1, 89, 92], "forward_prefetch": [1, 89], "limit_all_gath": [1, 89, 92], "show": 2, "basic": [2, 4, 29, 31], "It": [2, 13, 17, 19, 22, 30, 31, 36, 56, 74, 77], "found": [2, 42], "here": [2, 29, 31, 50, 54, 61], "http": [2, 3, 13, 20, 24, 30, 34, 37, 44, 45, 50, 52, 54, 61, 62, 63, 93, 106], "github": [2, 13, 30, 106], "com": [2, 30, 106], "pytorch": [2, 3, 5, 6, 16, 20, 24, 26, 28, 30, 31, 34, 37, 44, 45, 50, 52, 54, 61, 62, 63, 78, 81, 86, 93, 106, 125], "blob": [2, 106], "master": [2, 30], "train_unit_exampl": 2, "py": [2, 106], "less": [2, 74, 80], "code": [2, 3, 4, 9, 16, 29], "featur": 2, "enabl": [2, 3, 24, 56, 62, 93, 111, 113], "out": [2, 4, 81, 106], "box": [2, 4], "auto_unit_exampl": 2, "datapip": 2, "dataloader2": [2, 5, 6, 26, 28], "torchdata_train_exampl": 2, "convnet": 2, "dataset": [2, 3, 25, 29, 32, 33, 35, 38, 39], "main": [2, 24, 30, 31, 106], "class": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 29, 31, 32, 33, 34, 35, 36, 37, 38, 39, 46, 60, 63, 65, 66, 67, 68, 69, 70, 71, 72, 74, 77, 88, 89, 94, 104, 105, 106, 111, 112, 113, 114], "auto_unit": 3, "arg": [3, 11, 14, 31, 40, 58, 69, 71, 98, 99, 100, 101, 102, 103, 105, 114], "kwarg": [3, 14, 40, 58, 64, 69, 71, 78, 98, 99, 100, 101, 102, 103, 105, 111, 114], "sourc": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126], "stochast": 3, "gradient": [3, 9, 31], "descent": 3, "would": 3, "data": [3, 4, 5, 6, 11, 21, 25, 26, 28, 29, 30, 31, 40, 44, 67, 70, 93, 122], "parallel": [3, 93], "replic": [3, 24], "them": [3, 22, 31, 34, 70], "subclass": [3, 4, 6, 21, 23, 29, 31, 32, 36], "implement": [3, 5, 6, 7, 26, 28, 29, 31, 32, 63, 111, 113], "train_step": [3, 6, 17, 28, 29, 31], "eval_step": [3, 5, 6, 29], "predict_step": [3, 26, 29, 31], "method": [3, 24, 29, 31, 32, 33, 34, 35, 36, 37, 38, 39, 46, 50, 54, 58, 60, 61, 63, 65, 66, 67, 68, 69, 70, 71, 72, 74, 77, 88, 89, 94, 104, 105, 106, 111, 112, 113, 114], "For": [3, 21, 22, 24, 36, 37, 45, 48, 50, 54, 61, 62, 81, 85], "run": [3, 5, 6, 9, 11, 17, 26, 27, 28, 29, 30, 52, 78, 81, 85, 96, 108, 109, 110, 124, 125, 126], "forward": [3, 63, 77, 78], "backward": [3, 29, 31, 63, 77, 93], "step": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 65, 66, 68, 70, 74, 86, 95, 96, 97, 106, 112, 122, 123], "To": [3, 4, 29, 30, 78], "benefit": 3, "must": [3, 7, 8, 9, 22, 24, 31, 60, 61, 71, 78, 93, 106], "compute_loss": [3, 31], "configure_optimizers_and_lr_schedul": [3, 31], "addition": [3, 62], "option": [3, 4, 5, 6, 10, 11, 14, 17, 19, 21, 22, 23, 24, 26, 27, 28, 29, 31, 36, 46, 47, 50, 54, 56, 57, 59, 60, 61, 62, 65, 68, 74, 75, 78, 81, 85, 87, 88, 89, 91, 92, 93, 95, 96, 97, 98, 99, 100, 101, 103, 106, 110, 113, 117, 118, 120, 122], "hook": [3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 31, 88], "on_train_step_end": [3, 4, 6, 8, 9, 10, 11, 13, 15, 16, 17, 19, 21, 22, 23, 28, 31], "on_eval_step_end": [3, 4, 5, 9, 10, 11, 13, 15, 16, 19, 21, 23], "on_predict_step_end": [3, 4, 7, 9, 10, 11, 13, 15, 16, 19, 21, 23, 26], "overrid": [3, 29], "lr": [3, 31], "step_lr_schedul": 3, "case": [3, 29, 31, 47, 59], "thei": [3, 24, 70], "logic": [3, 4, 17, 29, 36, 37], "Then": [3, 29], "evalu": [3, 4, 6, 9, 10, 11, 14, 15, 16, 19, 21, 24, 27, 29, 30, 31], "predict": [3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 18, 19, 21, 23, 27, 29, 30, 31], "entri": [3, 4, 24, 27, 31, 81], "point": [3, 4, 9, 27, 29, 31, 48, 70], "normal": 3, "advanc": 3, "directli": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 31, 33, 34, 35, 37, 38, 39, 40, 42, 44, 45, 47, 50, 54, 56, 57, 58, 59, 60, 61, 62, 63, 65, 66, 68, 70, 71, 73, 74, 77, 78, 79, 80, 81, 85, 86, 87, 90, 91, 92, 93, 106, 107, 111, 113, 115, 117, 118, 119, 120, 122], "step_lr_interv": 3, "whether": [3, 8, 18, 22, 24, 27, 44, 60, 65, 77, 106, 111, 113, 120], "lr_schedul": [3, 5, 6, 26, 28, 29, 31], "everi": [3, 9, 17, 18, 22, 24, 25, 31], "default": [3, 7, 9, 14, 17, 18, 19, 24, 29, 32, 35, 36, 38, 44, 47, 50, 52, 53, 54, 57, 59, 61, 62, 65, 70, 72, 74, 81, 85, 90, 111, 113, 117, 118, 120, 122], "precis": [3, 30, 31, 45, 61, 70], "mix": [3, 31], "dtype": [3, 87], "accept": [3, 11, 104], "fp32": 3, "fp16": 3, "bf16": 3, "gradient_accumulation_step": [3, 31], "mani": 3, "batch": [3, 4, 11, 21, 23, 29, 31, 33, 34, 35, 37, 38, 39, 74, 76, 88], "accumul": [3, 31], "over": [3, 29, 31, 33, 35, 36, 37, 38, 39], "detect_anomali": 3, "anomali": [3, 31], "detect": [3, 17, 31], "autograd": 3, "engin": 3, "org": [3, 20, 24, 34, 37, 44, 45, 50, 52, 54, 61, 62, 63, 93], "doc": [3, 20, 34, 44, 45, 50, 52, 54, 61, 62, 93], "stabl": [3, 20, 34, 44, 45, 50, 52, 54, 61, 62, 93], "html": [3, 13, 20, 24, 34, 37, 44, 45, 50, 52, 54, 61, 62, 93], "clip_grad_norm": 3, "max": [3, 5, 6, 26, 28, 60, 122], "norm": [3, 76, 88], "clip": [3, 31], "gener": [3, 4, 9, 14, 24, 36, 37, 44, 45, 62, 70, 73, 78, 79, 93, 116, 119, 120], "util": [3, 5, 6, 10, 14, 20, 21, 23, 24, 26, 28], "clip_grad_norm_": 3, "clip_grad_valu": 3, "clip_grad_value_": 3, "swa_param": 3, "weight": [3, 38, 106], "averag": [3, 10, 106], "torch_compile_param": [3, 93], "compil": [3, 31, 93], "activation_checkpoint_param": [3, 93], "activ": [3, 14, 27, 78, 93], "creat": [3, 9, 29, 31, 44, 57, 71], "enable_compiled_autograd": [3, 93], "compiled_autograd": [3, 93], "an": [3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 15, 16, 17, 19, 21, 22, 23, 24, 26, 27, 28, 29, 31, 32, 34, 36, 54, 59, 60, 70, 80, 81, 84, 87, 90, 91, 92, 93, 107, 114, 122], "experiment": [3, 93], "certain": [3, 15, 44, 86], "through": [3, 36], "well": [3, 56, 74], "swaparam": 3, "swa": [3, 30], "shard": 3, "same": [3, 7, 9, 24, 29, 35, 36, 37, 47, 70, 76, 111], "avail": [3, 24, 41, 51, 55, 59, 61, 81, 85, 86, 111, 113, 120], "0": [3, 8, 19, 21, 24, 31, 33, 35, 38, 39, 51, 52, 54, 56, 59, 60, 62, 65, 66, 68, 70, 71, 88, 94, 98, 99, 100, 101, 102, 103, 106, 112, 115, 117, 118, 124, 125], "higher": 3, "abstract": [3, 29, 30, 31, 32, 66, 69], "tdata": [3, 27], "tupl": [3, 14, 29, 31, 78], "tensor": [3, 8, 17, 29, 31, 33, 35, 38, 39, 44, 47, 78, 86, 88], "ani": [3, 5, 6, 14, 24, 26, 28, 29, 31, 40, 58, 59, 62, 64, 71, 78, 98, 99, 100, 101, 102, 103, 111], "call": [3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 31, 40, 44, 50, 54, 56, 71, 86, 102, 111, 113], "object": [3, 5, 6, 9, 22, 26, 27, 28, 29, 33, 35, 36, 37, 38, 39, 57, 63, 78, 80, 88, 95, 96, 97, 104, 118, 119, 122], "return": [3, 27, 29, 31, 33, 35, 38, 39, 40, 42, 43, 47, 51, 55, 56, 57, 58, 59, 61, 64, 82, 83, 84, 96, 97, 107, 115, 117, 118], "contain": [3, 24, 27, 29, 30, 31, 32, 33, 34, 36, 57, 77, 78, 87], "output": [3, 7, 19, 27, 29, 31, 70, 77, 78, 81, 85, 122], "part": [3, 31], "lrschedul": [3, 104], "construct": [3, 34, 44, 71, 122], "upon": [3, 24], "A": [3, 4, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 33, 35, 36, 37, 38, 39, 42, 46, 54, 58, 63, 72, 73, 78, 86, 97, 111, 113, 115, 117, 118], "requir": [3, 29, 62, 63], "iter": [3, 5, 6, 10, 21, 24, 25, 26, 27, 28, 29, 33, 34, 35, 36, 37, 38, 39, 89, 95, 96, 97, 122], "wish": [3, 29], "decor": [3, 29, 56], "inference_mod": [3, 29], "improv": [3, 8, 9, 29, 60], "metadata": [3, 29], "get_next_eval_batch": [3, 5, 29], "data_it": [3, 29], "union": [3, 4, 7, 10, 11, 12, 18, 19, 20, 22, 23, 24, 25, 29, 33, 35, 36, 37, 38, 39, 57, 59, 62, 88, 89, 90, 93, 104, 122], "next": [3, 4, 11, 29, 35], "input": [3, 29, 31, 35, 57, 59, 62, 77, 115, 117, 118, 119], "otherwis": [3, 9, 29, 44, 51, 55, 106], "get": [3, 4, 19, 29, 37, 41, 42, 43, 50, 51, 52, 53, 54, 55, 124, 125], "get_next_predict_batch": [3, 26, 29], "get_next_train_batch": [3, 6, 28, 29], "int": [3, 5, 6, 8, 9, 10, 14, 17, 19, 21, 22, 23, 24, 26, 27, 28, 31, 32, 34, 50, 51, 52, 54, 55, 58, 59, 60, 62, 65, 66, 68, 70, 73, 75, 80, 81, 88, 89, 94, 95, 96, 97, 107, 111, 121, 122, 123], "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 37, 38, 39, 44, 45, 46, 47, 48, 49, 50, 54, 56, 57, 59, 60, 61, 62, 63, 65, 66, 67, 68, 70, 71, 72, 73, 74, 76, 77, 78, 80, 81, 85, 86, 88, 89, 91, 92, 93, 94, 96, 97, 98, 99, 100, 101, 102, 103, 104, 106, 111, 112, 113, 117, 118, 120, 121, 122, 123], "end": [3, 4, 7, 8, 9, 10, 11, 13, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 27, 29, 31], "befor": [3, 4, 7, 9, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 25, 29, 63, 65, 66, 68, 74, 111, 113], "updat": [3, 9, 19, 24, 30, 31, 106, 121, 123], "log": [3, 10, 12, 14, 15, 17, 18, 20, 21, 23, 24, 25, 30, 31, 65, 66, 67, 68, 70, 71, 98, 99, 100, 101, 103, 111, 113, 120], "metric": [3, 8, 24, 30, 31, 60, 69, 70], "do": [3, 8, 21, 30, 31, 70], "anyth": 3, "els": [3, 56, 65, 66, 68], "been": [3, 22, 33, 39, 61], "complet": [3, 24, 27, 122, 123], "on_train_epoch_end": [3, 4, 6, 8, 11, 15, 17, 19, 20, 21, 22, 25, 28, 29, 31], "note": [3, 13, 57, 62], "rememb": 3, "super": [3, 29, 31], "result": [3, 9, 31, 47, 59, 72, 112, 116], "trainstepresult": [3, 31], "total": [3, 24, 32, 96, 97], "extract": 3, "autopredictunit": 3, "str": [3, 4, 7, 8, 12, 14, 21, 22, 24, 31, 33, 35, 36, 37, 38, 39, 42, 43, 45, 50, 53, 54, 57, 58, 59, 61, 62, 64, 65, 66, 68, 71, 74, 78, 79, 81, 85, 87, 89, 90, 93, 104, 115, 116, 117, 118, 119, 120, 122], "torchcompileparam": [3, 93], "bool": [3, 24, 27, 36, 59, 60, 65, 66, 68, 79, 82, 83, 84, 88, 89, 93, 106, 108, 109, 113, 120, 126], "tpredictdata": [3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 18, 19, 21, 23, 24, 26, 29], "extens": [4, 31], "supplement": [4, 24], "loop": [4, 5, 6, 9, 11, 15, 22, 26, 27, 28, 29, 30, 31, 94, 97, 122], "addit": [4, 24, 29, 31, 44, 111], "good": [4, 70], "candid": 4, "ones": [4, 24], "re": [4, 63, 86], "across": [4, 7, 9, 15, 24, 25, 48, 59, 62, 117, 118], "intend": [4, 31, 32, 61], "go": 4, "write": [4, 7, 25, 44, 65, 66, 68, 71, 85], "add": [4, 48], "below": [4, 5, 6, 26, 28, 29], "exampl": [4, 5, 6, 11, 21, 22, 24, 26, 28, 29, 33, 34, 35, 36, 37, 38, 39, 56, 57, 58, 59, 63, 67, 70, 71, 74, 91, 92, 107, 124, 125], "print": [4, 11, 14, 18, 31, 33, 35, 38, 39, 59, 70, 79, 102], "messag": [4, 19, 84, 98, 99, 100, 101, 103, 122], "variou": [4, 30, 31], "execut": [4, 5, 6, 9, 26, 27, 28, 56, 60, 61], "import": [4, 5, 6, 9, 11, 26, 28, 29, 31, 56, 63, 67, 70, 71, 107], "tevalunit": [4, 31], "tpredictunit": [4, 31], "ttrainunit": [4, 31], "printingcallback": [4, 31], "def": [4, 11, 29, 31, 56], "on_train_start": [4, 6, 9, 11, 14, 15, 16, 22, 24, 25, 28, 29, 31], "self": [4, 29, 31], "start": [4, 7, 9, 11, 12, 14, 15, 16, 18, 19, 21, 22, 24, 25, 27, 29, 31, 74, 106], "on_train_end": [4, 6, 9, 10, 11, 15, 16, 21, 28, 29, 31], "on_eval_start": [4, 5, 9, 11, 14, 15, 16, 21, 29, 31], "on_eval_end": [4, 5, 9, 10, 11, 15, 16, 21, 29, 31], "on_predict_start": [4, 7, 9, 11, 14, 15, 16, 21, 26, 29, 31], "on_predict_end": [4, 7, 9, 10, 11, 15, 16, 21, 26, 29, 31], "instanti": [4, 13, 31, 74], "printing_callback": 4, "train_unit": [4, 28, 29], "properti": [4, 24, 27], "distinct": 4, "per": [4, 5, 6, 21, 26, 27, 28, 70, 111, 122], "instanc": [4, 5, 6, 10, 13, 15, 20, 21, 23, 24, 26, 27, 28, 36, 74, 90, 91, 92, 107], "debug": [4, 15, 17, 27, 31, 99], "profil": [4, 16, 72, 74], "purpos": 4, "tevaldata": [4, 5, 6, 7, 9, 10, 11, 13, 14, 15, 16, 18, 19, 21, 23, 24, 29], "on_eval_epoch_end": [4, 5, 11, 15, 19, 29], "on_eval_epoch_start": [4, 5, 11, 15, 18, 19, 29], "new": [4, 12, 15, 18, 19, 21, 29, 50, 57, 71], "on_eval_get_next_batch_end": [4, 11], "on_eval_step_start": [4, 5, 11, 15, 18], "on_except": [4, 7, 11, 24], "ttraindata": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 29], "exc": [4, 7, 24], "baseexcept": [4, 7, 11, 24, 82, 83, 84], "except": [4, 5, 6, 7, 11, 24, 26, 28, 36, 82, 83, 84], "occur": [4, 7, 11, 24, 25, 81, 106], "on_predict_epoch_end": [4, 11, 15, 19, 26, 29], "on_predict_epoch_start": [4, 11, 15, 18, 19, 26, 29], "on_predict_get_next_batch_end": [4, 11], "on_predict_step_start": [4, 11, 15, 18, 26], "on_train_epoch_start": [4, 6, 11, 12, 15, 18, 19, 21, 28, 29], "on_train_get_next_batch_end": [4, 11], "on_train_step_start": [4, 6, 11, 12, 15, 18, 28], "sever": [4, 29, 31, 47], "pre": 4, "written": [4, 7, 71], "readi": 4, "eval_unit": [5, 29], "eval_dataload": [5, 6, 96], "max_steps_per_epoch": [5, 26, 27, 28, 95, 97, 122], "list": [5, 6, 7, 12, 14, 15, 18, 21, 24, 25, 26, 28, 47, 58, 72, 73, 115, 117], "timer": [5, 6, 21, 26, 27, 28, 30], "timerprotocol": [5, 6, 26, 27, 28, 111, 113, 118, 119], "take": [5, 6, 9, 24, 26, 28], "modifi": [5, 6, 26, 27, 28, 29], "includ": [5, 6, 18, 26, 28, 30, 31, 37, 61, 88, 94], "etc": [5, 6, 14, 17, 24, 26, 28, 31, 36, 37, 58], "number": [5, 6, 9, 19, 21, 24, 26, 27, 28, 32, 34, 47, 50, 54, 58, 60, 62, 65, 66, 68, 70, 77, 81, 95, 96, 97, 106, 107, 111, 122, 123], "mean": [5, 6, 26, 28, 63, 77, 115, 117, 118], "until": [5, 6, 26, 28, 33], "exhaust": [5, 6, 26, 28, 33, 35, 38, 39], "kei": [5, 6, 24, 26, 27, 28, 33, 35, 36, 37, 38, 39, 42, 43, 72], "event": [5, 6, 26, 27, 28, 71, 74, 120], "synchron": [5, 6, 9, 26, 28, 48, 50, 56, 59, 71, 111, 113, 117, 118, 120], "degrad": [5, 6, 26, 28], "myevalunit": [5, 29], "20": [5, 22, 26, 57], "pseudocod": [5, 6, 26, 28], "what": [5, 6, 24, 26, 28, 106], "doe": [5, 6, 8, 9, 26, 28, 86], "first": [5, 6, 15, 22, 26, 28, 30, 86], "while": [5, 6, 26, 28, 33, 39], "try": [5, 6, 26, 28], "increment": [5, 6, 26, 28], "counter": [5, 6, 26, 28, 63], "stopiter": [5, 6, 26, 28], "break": [5, 6, 26, 28], "max_epoch": [6, 27, 28, 31], "max_step": [6, 27, 28, 95, 96, 97, 122], "max_train_steps_per_epoch": [6, 96], "max_eval_steps_per_epoch": [6, 96], "evaluate_every_n_step": [6, 27], "evaluate_every_n_epoch": [6, 27], "interleav": [6, 29, 31, 34], "both": [6, 22], "limit": [6, 22, 28], "infinit": [6, 28, 60], "unless": [6, 28], "stop": [6, 8, 22, 27, 28, 30, 33, 38, 39, 60], "often": [6, 22], "term": [6, 25, 27], "fit_unit": 6, "myfitunit": 6, "4": [6, 28, 33, 35, 38, 39, 59, 70], "header_row": 7, "dir_path": 7, "delimit": 7, "t": [7, 31, 40, 44, 62, 63, 96, 97], "filenam": [7, 50, 85], "csv": [7, 65], "file": [7, 13, 19, 50, 61, 65, 66, 68, 71, 74, 122], "simplifi": [7, 30, 31], "extend": [7, 29], "get_step_output_row": 7, "desir": [7, 56], "row": 7, "all": [7, 9, 13, 14, 24, 31, 33, 35, 37, 38, 47, 48, 57, 59, 65, 66, 68, 71, 119], "match": 7, "column": 7, "defin": [7, 22, 27, 29, 31, 36, 37, 39, 71, 91, 92, 105, 111, 114], "directori": [7, 13, 24, 74, 81, 85], "where": [7, 13, 19, 24, 29, 44, 47, 58, 74, 122], "separ": 7, "tab": 7, "monitored_attr": 8, "early_stop_check": 8, "earlystopcheck": 8, "interv": [8, 22, 31, 72, 73, 112], "liter": [8, 18, 22, 59, 60, 61, 106], "interval_freq": [8, 22], "check": [8, 17, 22, 60, 106], "earli": [8, 13, 30, 60], "rank": [8, 15, 17, 19, 21, 22, 24, 30, 50, 51, 52, 54, 56, 58, 59, 65, 66, 68, 70, 71, 98, 99, 100, 101, 102, 103, 107, 112, 117, 118], "step_interv": 9, "period": [9, 24, 72, 73], "garbag": 9, "collect": [9, 13, 21, 24, 46, 71, 77], "In": [9, 29, 47, 59, 60], "fulli": 9, "program": [9, 41, 44, 61, 126], "multipl": [9, 44, 45, 61, 104], "These": [9, 29, 31, 127], "need": [9, 24, 29, 31, 44, 56, 106, 127], "commun": [9, 22, 24, 54, 58, 88], "other": [9, 17, 24, 59, 112], "especi": [9, 25], "overal": 9, "therefor": 9, "gate": 9, "slowest": [9, 17], "roughli": 9, "amount": [9, 22], "its": [9, 44, 77, 78], "straggler": 9, "python": [9, 62, 108, 109, 124], "trigger": [9, 17], "differ": [9, 17, 24, 29, 30, 31, 47, 70], "possibl": [9, 13, 22], "lead": 9, "frequenc": [9, 10, 17, 21, 23, 24, 27, 31], "tune": 9, "base": [9, 24, 32, 41, 61, 63, 84, 106], "hand": 9, "free": [9, 44, 54, 58, 74], "some": [9, 29, 86], "reap": 9, "minim": 9, "overhead": 9, "compar": [9, 17], "full": 9, "cleanup": 9, "logger": [10, 12, 17, 18, 20, 21, 23, 25, 30, 31, 98, 99, 100, 101, 103], "metriclogg": [10, 12, 17, 18, 21, 23, 25], "summarywrit": [10, 20, 23, 71], "moving_avg_window": 10, "log_every_n_step": [10, 21, 23, 31], "scalar": [10, 23], "tensorboard": [10, 20, 23, 31, 71], "tensorboardlogg": [10, 20, 31], "control": [10, 13, 21, 23, 24, 29, 31, 62], "window": [10, 126], "callabl": [11, 14, 56, 58, 88, 89, 110], "retriev": 11, "mydataload": 11, "print_on_step_start": 11, "f": [11, 59], "eval_progress": 11, "num_steps_complet": [11, 31, 94, 95, 121, 122, 123], "lambda_cb": 11, "logging_interv": [12, 18], "associ": 12, "memory_snapshot_profil": 13, "memorysnapshotprofilerbas": 13, "memori": [13, 18, 30, 34, 44, 67, 74, 81, 85, 86], "snapshot": [13, 24, 74, 81, 85], "pickl": 13, "zdevito": 13, "io": 13, "2022": 13, "08": 13, "16": [13, 21], "recommend": [13, 15, 17, 21, 31, 34], "ideal": [13, 63, 74], "sure": [13, 17, 30], "alloc": [13, 44, 74, 86], "captur": [13, 72], "max_depth": [14, 80], "process_fn": 14, "module_summari": 14, "_log_module_summary_t": 14, "module_input": [14, 63], "mutablemap": [14, 78], "summari": [14, 30, 77, 80, 119], "maximum": [14, 22, 27, 80, 81], "depth": [14, 80], "tabl": 14, "map": [14, 21, 33, 35, 37, 38, 39, 42, 43, 115, 117, 118], "flop": [14, 30, 77, 78], "size": [14, 18, 21, 32, 47, 55, 72, 73, 77, 78], "rais": [14, 22, 36, 41, 42, 60, 62, 74, 80, 87, 90, 111, 113, 115, 117, 118, 119, 120], "runtimeerror": [14, 41], "torchev": 14, "instal": 14, "simpl": [15, 29, 67, 71], "progress": [15, 19, 24, 25, 30, 31, 104, 121, 122, 123], "issu": [15, 30, 46], "root": [15, 80], "caus": [15, 17], "might": [15, 44, 104], "unequ": 15, "nccl": [15, 17, 58], "timeout": [15, 17, 61], "item": [15, 21, 32, 33, 35, 38, 39], "context": [16, 41, 63, 73], "manag": [16, 24, 63, 73], "check_every_n_step": 17, "check_every_n_epoch": 17, "pg": [17, 46, 59, 117, 118], "processgroup": [17, 24, 46, 47, 59, 88, 89, 112, 117, 118], "slow": 17, "n": [17, 24, 59], "lag": 17, "behind": 17, "between": [17, 21, 22, 60, 76], "fastest": 17, "report": [17, 21], "all_gather_tensor": 17, "store": [17, 66, 68, 72, 104, 111, 113, 114], "infer": [17, 31, 122], "environ": [17, 19, 30, 41, 50, 52, 54, 61, 71, 125], "system": [18, 50, 126], "stat": [18, 31, 42, 43], "cpu": [18, 27, 41, 43, 57, 82], "usag": 18, "resid": [18, 72, 73], "gpu": [18, 41, 42, 111, 113], "refresh_r": [19, 121, 123], "textio": [19, 122], "stringio": [19, 122], "bar": [19, 121, 122, 123], "visual": [19, 21, 25, 74], "determin": [19, 22, 45, 60, 62, 108, 109], "sy": [19, 122], "stderr": [19, 122], "histogram": [20, 115, 117], "writer": 20, "throughput_per_batch": 21, "throughput": 21, "qp": 21, "second": [21, 61, 75], "basi": 21, "measur": [21, 63, 72, 73, 112, 120], "divid": 21, "took": 21, "On": [21, 71], "granular": [21, 48], "leverag": [21, 34], "alreadi": [21, 34, 49, 61, 106], "wait": [21, 23], "calcul": [21, 77, 78, 96], "correspond": [21, 47], "instac": 21, "queri": 21, "32": 21, "two": [21, 22, 30, 31, 39, 76], "chart": 21, "8": [21, 33, 35, 38, 39, 107, 124], "label": 21, "could": 21, "accur": [21, 111, 113, 120], "place": [21, 29, 31, 86], "durat": [22, 115, 116, 117, 118], "timedelta": [22, 61, 72, 73, 112], "timestamp": 22, "datetim": [22, 61, 72, 73], "spent": 22, "reach": [22, 111], "job": 22, "absolut": [22, 60], "At": 22, "least": [22, 59], "condit": [22, 51, 55], "met": [22, 51, 55], "spend": 22, "form": 22, "dd": 22, "hh": 22, "mm": 22, "dai": [22, 75], "hour": 22, "minut": [22, 61], "00": 22, "indic": [22, 24, 33, 35, 36, 37, 38, 39, 97], "even": [22, 24], "ha": [22, 30, 31, 33, 36, 37, 39, 60, 61, 119], "yet": 22, "timezon": 22, "awar": 22, "exceed": 22, "valueerror": [22, 60, 62, 74, 80, 87, 90, 111, 113, 115, 117, 118, 119, 120], "i": [22, 47, 58], "e": [22, 29, 31, 79], "process_group": [24, 88, 89], "async_checkpoint": 24, "storage_opt": 24, "knob_opt": 24, "knobopt": 24, "appstatemixin": 24, "random": [24, 32, 62], "epoch_": 24, "_step_": 24, "parent": [24, 27], "intra": 24, "most": [24, 120], "recent": 24, "excess": 24, "present": 24, "oldest": [24, 111], "delet": 24, "clean": 24, "best": 24, "config": [24, 107], "read": [24, 27, 36, 37], "off": 24, "prior": 24, "entir": 24, "world": [24, 46, 47, 55], "asynchron": [24, 65, 112], "glob": 24, "pattern": 24, "inform": [24, 27, 45, 50, 54, 57, 61, 77, 79, 81, 85], "see": [24, 31, 45, 50, 54, 61, 62, 81, 85, 106], "api_refer": 24, "safer": 24, "realli": 24, "thing": 24, "grad_scal": 24, "mark": 24, "unsur": 24, "leav": 24, "field": 24, "unset": 24, "keyword": [24, 40, 71], "storag": 24, "plugin": 24, "document": [24, 36, 37], "knob": 24, "constructor": 24, "oper": [24, 34, 45, 61, 62, 71, 126], "broadcast": [24, 47, 59], "state_dict": [24, 86, 94, 104], "castabl": 24, "maintain": [24, 30, 31], "accuraci": [24, 31, 67, 70, 71], "respons": 24, "reset": [24, 31, 63, 112, 114], "collis": 24, "app": [24, 46], "static": 24, "restor": [24, 86], "strict": 24, "skip": [24, 33, 36, 39, 106, 110], "filter": 24, "allow": [24, 29, 46, 106], "app_stat": 24, "vs": [25, 79], "predict_unit": [26, 29], "predict_dataload": 26, "mypredictunit": [26, 29], "entry_point": 27, "entrypoint": [27, 107], "train_stat": 27, "tstepoutput": 27, "eval_st": 27, "predict_st": 27, "phase": [27, 29], "active_phas": 27, "activephas": 27, "current": [27, 41, 59, 61, 78, 95, 97, 124, 125, 126], "One": 27, "active_phase_st": 27, "meta": 27, "should_stop": 27, "termin": 27, "signal": [27, 60], "record": [27, 44, 74, 81, 115, 116, 117, 118, 119], "latenc": 27, "iteration_tim": 27, "alwai": 27, "without": [27, 60], "synchronis": 27, "step_output": 27, "last": 27, "mytrainunit": [28, 29], "concept": [29, 31], "repres": [29, 31, 88, 89], "primari": [29, 31], "organ": 29, "mutual": [29, 31], "exclus": [29, 31], "g": [29, 31, 79], "behavior": [29, 111], "fetch": [29, 50, 54], "typecheck": 29, "__init__": [29, 31, 32, 33, 34, 35, 36, 37, 38, 39, 46, 60, 63, 65, 66, 67, 68, 69, 70, 71, 72, 74, 77, 88, 89, 94, 104, 105, 106, 111, 112, 113, 114], "_lrschedul": 29, "target": [29, 31], "binary_cross_entropy_with_logit": [29, 31], "zero_grad": [29, 31], "plan": 29, "refer": [29, 36, 37, 48], "my_unit": [29, 31], "librari": [30, 31, 62], "tool": [30, 31], "compon": [30, 31], "level": [30, 31], "repo": [30, 31], "lightweight": [30, 31], "grab": [30, 31], "bag": [30, 31], "independ": [30, 31, 127], "relat": [30, 31, 82, 83, 127], "wrapper": [30, 31, 46, 104], "publish": [30, 31], "pip": 30, "version": [30, 106], "just": 30, "git": 30, "upgrad": 30, "checker": 30, "filesystem": [30, 64], "spec": 30, "memorysnapshotprofil": 30, "oom": [30, 74], "prepar": 30, "zero": [30, 74, 86], "test": [30, 110], "tqdm": 30, "misc": 30, "welcom": 31, "descript": [31, 122], "immedi": 31, "combin": 31, "myexampleunit": 31, "_modul": 31, "_devic": 31, "_optim": 31, "_log_every_n_step": 31, "_accuraci": 31, "binaryaccuraci": 31, "_tb_logger": 31, "trainer": 31, "our": 31, "task": 31, "copy_data_to_devic": 31, "squeez": 31, "step_count": 31, "train_progress": 31, "acc": 31, "log_dict": [31, 70], "train_accuraci": 31, "train_accuracy_epoch": 31, "predictbatch": 31, "256": 31, "10": [31, 33, 35, 38, 39, 67, 71, 74], "1000": 31, "5": [31, 33, 35, 38, 39, 59, 74], "howev": 31, "don": [31, 62], "necessarili": 31, "themselv": 31, "appli": [31, 106, 111], "tb_logger": 31, "multiclassaccuraci": 31, "gamma": 31, "tlrschedul": 31, "adadelta": 31, "steplr": 31, "step_siz": 31, "nll_loss": 31, "_": 31, "mechan": [31, 33, 38, 39], "inject": 31, "within": [31, 41, 62], "wai": 31, "page": 31, "detail": [31, 36, 37, 62], "suit": 31, "rang": [31, 33, 35, 38, 39, 41, 59, 62, 111, 115, 117, 118], "concret": 32, "_generate_random_item": 32, "produc": 32, "singl": [32, 35, 46, 58, 78, 107], "titem": 32, "individual_dataload": [33, 35, 36, 37, 38, 39], "iteration_strategi": [33, 35, 36, 37, 38, 39], "alldatasetbatch": 33, "all_datasets_exhaust": [33, 38, 39], "finish": 33, "till": [33, 35, 39], "largest": [33, 39], "those": [33, 39], "smallest_dataset_exhaust": [33, 39], "onc": [33, 39, 44, 60], "smallest": [33, 39], "restart_until_all_datasets_exhaust": 33, "restart": 33, "format": [33, 35, 38, 39, 116], "dataloader_1_nam": 33, "batch_obtained_from_dataloader_1": 33, "dataloader_2_nam": 33, "batch_obtained_from_dataloader_2": 33, "loader": [33, 35, 38, 39], "batch_siz": [33, 35, 38, 39], "b": [33, 35, 38, 39], "15": [33, 35, 38, 39], "all_dataset_batch_strategi": 33, "stopping_mechan": [33, 38, 39], "stoppingmechan": [33, 38, 39], "combined_iter": [33, 35, 38, 39], "6": [33, 35, 38, 39], "7": [33, 35, 38, 39], "9": [33, 35, 38, 39], "11": [33, 35, 38, 39], "12": [33, 35, 38, 39, 125], "13": [33, 35, 38, 39, 63, 78], "14": [33, 35, 38, 39], "data_iter": 34, "num_prefetch_batch": 34, "prefetch": 34, "host": [34, 81, 85], "copi": [34, 40, 63, 106], "effect": 34, "pin": 34, "data_prefetch": 34, "inord": 35, "order": [35, 37, 39, 70, 112, 120], "overridden": 35, "repetit": 35, "dataloader_nam": [35, 38, 39], "batch_from_dataload": [35, 38, 39], "randomizedbatchsampl": [35, 38], "in_order_strategi": 35, "randomizedbatchsampleriter": 35, "dataiterationstrategi": [36, 37], "iterator_cl": 36, "multiiter": 36, "ignore_empty_data": 36, "cycl": [36, 37, 39], "individu": [36, 37], "dictionari": [36, 111, 113, 115, 117, 118], "torchdata": [36, 37], "multi": [36, 37, 58, 107], "achiev": [36, 37], "mux": [36, 37], "mux_longest": [36, 37], "zip": [36, 37], "pleas": [36, 37, 48], "given": [37, 60, 64, 112, 119, 120], "accompani": 37, "particular": 37, "beta": 37, "randomli": 38, "sampl": [38, 111], "chang": [38, 60], "anoth": [38, 44], "randomized_batch_sampl": 38, "roundrobin": 39, "robinrobin": 39, "round_robin_strategi": 39, "recurs": 40, "posit": [40, 71], "correct": 40, "mp": 41, "reli": [41, 86], "local_rank": [41, 52], "variabl": [41, 52, 71], "made": 41, "launcher": [41, 107], "outsid": [41, 62], "gpustat": 42, "nvidia": 42, "smi": 42, "utilization_gpu_perc": 42, "utilization_memory_perc": 42, "fan_speed_perc": 42, "memory_used_mb": 42, "memory_free_mb": 42, "temperature_gpu_celsiu": 42, "temperature_memory_celsiu": 42, "filenotfounderror": 42, "command": 42, "cpustat": 43, "psutil": 43, "cpu_vm_perc": 43, "cpu_perc": 43, "cpu_swap_perc": 43, "worker_cpu_time_us": 43, "worker_cpu_time_system": 43, "worker_rss": 43, "stream": [44, 120], "element": 44, "being": [44, 120], "reus": 44, "mention": 44, "record_stream": 44, "cach": 44, "freed": 44, "newli": 44, "trace": [44, 81], "still": 44, "wa": 44, "tell": 44, "underli": 44, "longer": 44, "creator": 44, "notabl": 44, "trick": 44, "high": [45, 61], "float32": 45, "matrix": [45, 61], "convolut": 45, "set_float32_matmul_precis": 45, "backend": [45, 53, 58, 61], "cudnn": [45, 62], "allow_tf32": 45, "datatyp": 45, "consist": 46, "fashion": 46, "regardless": 46, "follow": [46, 61, 70, 77], "scenario": 46, "gather": 47, "onto": 47, "dimens": [47, 57], "pad": 47, "trim": 47, "secur": 47, "equal": [47, 61, 74], "workload": 47, "sync": [47, 88, 115, 117, 118], "gathered_result": 47, "pgwrapper": 48, "destroi": 49, "world_siz": [50, 54, 55, 58], "init": [50, 54], "tcp": [50, 54, 61], "protocol": [50, 54, 114], "share": 50, "worker": [50, 54], "get_world_s": [50, 54], "get_global_rank": [50, 54], "temporari": 50, "env": [51, 55], "var": [51, 55], "neither": [51, 55, 74], "popul": 52, "elast": 52, "hostnam": 54, "port": [54, 58], "address": 54, "belong": [54, 70], "localhost": [54, 58], "select": 54, "fn": 56, "treturn": [56, 58, 110], "judici": 56, "never": 56, "veri": 56, "carefulli": 56, "mutat": 56, "local": 56, "foo": 56, "x": 56, "wrapped_fn": 56, "helper": [57, 116], "convert": [57, 75, 87, 90], "syncbatchnorm": 57, "layer": 57, "batchnorm": 57, "revert": 57, "convert_sync_batchnorm": 57, "origin": 57, "network": 57, "sequenti": 57, "batchnorm1d": 57, "sync_bn_modul": 57, "reverted_modul": 57, "method_arg": 58, "method_kwarg": 58, "spawn": 58, "node": [58, 107], "gloo": 58, "l": 58, "methods_kwarg": 58, "val": 59, "coherence_mod": 59, "rank_zero": 59, "boolean": 59, "member": 59, "manner": 59, "receiv": 59, "truth": 59, "integ": [59, 62, 122], "ratio": 59, "synced_v": 59, "iff": 59, "success": [59, 70], "patienc": 60, "min_delta": 60, "check_finit": 60, "threshold_mod": 60, "ab": 60, "rel": 60, "stopping_threshold": 60, "divergence_threshold": 60, "decreas": 60, "increas": 60, "minimum": 60, "qualifi": 60, "improvement_threshold": 60, "best_val": 60, "threshold": 60, "becom": 60, "nan": 60, "delta": [60, 72, 73], "beyond": 60, "wors": 60, "than": [60, 74, 80, 111], "device_typ": 61, "dist_init_method_typ": 61, "pg_backend": 61, "pg_timeout": 61, "1800": 61, "float32_matmul_precis": 61, "launch": [61, 107], "spmd": 61, "style": [61, 106], "against": 61, "30": 61, "determinist": 62, "pseudo": 62, "commonli": 62, "numpi": 62, "error": [62, 81, 84, 100], "warn": [62, 103], "nondeterminist": 62, "benchmark": 62, "disabl": 62, "set_deterministic_debug_mod": 62, "algorithm": 62, "count": 63, "dev": 63, "discuss": 63, "dispatch": 63, "505": 63, "torchvis": 63, "resnet18": 63, "randn": 63, "224": 63, "ftdm": 63, "flops_forward": 63, "deepcopi": [63, 106], "flop_count": 63, "flops_backward": 63, "abstractfilesystem": 64, "steps_before_flush": [65, 66, 68], "log_all_rank": [65, 66, 68], "async_writ": 65, "header": 65, "buffer": [65, 67], "flush": [65, 66, 68], "23": [67, 71], "56": [67, 71], "close": [67, 71, 121], "json": 68, "stdout": 70, "line": 70, "were": 70, "treat": 70, "opaqu": 70, "identifi": 70, "consecut": 70, "practic": 70, "digit": 70, "decim": 70, "rule": 70, "round": [70, 72], "usual": 70, "982378": 70, "23112": 70, "payload": 70, "99123": 70, "18787": 70, "9824": 70, "2311": 70, "9912": 70, "1879": 70, "extra": 71, "tmp": [71, 74], "tb_log": 71, "microsecond": [72, 73], "100000": [72, 73, 74], "rss": [72, 73], "baselin": [72, 73], "rss_deltas_byt": 72, "100m": 72, "byte": [72, 73, 77], "rss_delta": 73, "output_dir": [74, 81, 85], "memory_snapshot_param": 74, "memorysnapshotparam": 74, "histori": 74, "dump": 74, "offlin": 74, "stai": 74, "constant": 74, "account": 74, "start_step": 74, "neg": 74, "stop_step": 74, "greater": [74, 78], "nor": 74, "enable_oom_observ": 74, "src_modul": 76, "dst_modul": 76, "transfer": 76, "statist": 76, "submodul": [77, 78], "trainabl": 77, "estim": [77, 95, 96, 97], "uniniti": 77, "shape": 77, "elaps": [77, 112, 120], "ms": 77, "module_arg": 78, "module_kwarg": 78, "modulesummari": [78, 79, 80], "assign": 78, "tree": [78, 80], "summar": 78, "lazi": 78, "NOT": 78, "todo": 78, "flexibl": [78, 106], "human_readable_num": 79, "summary_t": 79, "tabular": [79, 116], "exact": 79, "1234": 79, "k": 79, "prune": 80, "deeper": 80, "prun": 80, "inplac": 80, "trace_max_entri": 81, "1000000": 81, "attach": 81, "blog": [81, 85], "post": [81, 85], "due": 84, "file_prefix": 85, "prefix": 85, "memory_snapshot": 85, "grad": 86, "necessari": [86, 104], "becaus": [86, 104], "adamw": 86, "lazili": 86, "solut": 86, "ensur": [86, 106, 111, 113], "invalid": [87, 90], "output_devic": 88, "dim": 88, "bucket_cap_mb": 88, "25": 88, "find_unused_paramet": [88, 91], "gradient_as_bucket_view": [88, 91], "static_graph": 88, "comm_stat": 88, "comm_hook": 88, "gradbucket": 88, "futur": 88, "sync_batchnorm": 88, "regist": 88, "sharding_strategi": 89, "shardingstrategi": 89, "cpu_offload": 89, "cpuoffload": 89, "auto_wrap_polici": 89, "backward_prefetch": 89, "backwardprefetch": 89, "backward_pr": 89, "mixed_precis": 89, "mixedprecis": 89, "ignored_modul": 89, "param_init_fn": 89, "sync_module_st": 89, "use_orig_param": 89, "state_dict_config": 89, "statedictconfig": 89, "optim_state_dict_config": 89, "optimstatedictconfig": 89, "noopstrategi": 90, "api": [91, 92, 104], "ddp_modul": 91, "fsdp_modul": 92, "activationcheckpointparam": 93, "noop": 93, "num_epochs_complet": [94, 122], "num_steps_completed_in_epoch": 94, "load_state_dict": 94, "remain": 95, "eval_every_n_step": 96, "eval_every_n_epoch": 96, "couldn": [96, 97], "critic": 98, "info": 101, "stateful_obj": 104, "fsdpoptimizerwrapp": 104, "load_checkpoint": 104, "use_buff": 106, "averaging_method": 106, "ema": 106, "ema_decai": 106, "999": 106, "skip_deepcopi": 106, "use_lit": 106, "streamlin": 106, "give": 106, "compat": 106, "swa_util": 106, "l66": 106, "entail": 106, "exponenti": 106, "decai": 106, "ignor": 106, "somewai": 106, "lit": 106, "adjust": 106, "small": 106, "approach": 106, "nproc": 107, "launchconfig": 107, "pet": 107, "launch_config": 107, "elastic_launch": 107, "interpret": [108, 109], "asan": [108, 110], "tsan": 109, "func": 110, "lower_bound": 111, "upper_bound": 111, "recorded_dur": [111, 113, 114, 115, 117], "size_bound": 111, "lower": 111, "upper": 111, "bound": 111, "smaller": 111, "remov": 111, "action": [111, 115, 117, 118, 119], "cuda_sync": [111, 113, 120], "verbos": [111, 113], "incur": [111, 113], "hit": [111, 113], "cpu_pg": 112, "propag": 112, "previou": 112, "block": 112, "percentil": [115, 117, 118], "sequenc": [115, 117, 118], "whose": 118, "action_nam": 120, "progress_bar": [121, 123], "tqdm_asyncio": [121, 122, 123], "desc": 122, "far": 122, "he": 122, "reflect": 123, "runtim": [124, 125], "Is": 126}, "objects": {"torchtnt.framework.auto_unit": [[3, 0, 1, "", "AutoPredictUnit"], [3, 0, 1, "", "AutoUnit"]], "torchtnt.framework.auto_unit.AutoPredictUnit": [[3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "predict_step"]], "torchtnt.framework.auto_unit.AutoUnit": [[3, 1, 1, "", "compute_loss"], [3, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [3, 1, 1, "", "eval_step"], [3, 1, 1, "", "get_next_eval_batch"], [3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "get_next_train_batch"], [3, 1, 1, "", "on_eval_step_end"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "on_train_epoch_end"], [3, 1, 1, "", "on_train_step_end"], [3, 1, 1, "", "predict_step"], [3, 1, 1, "", "step_lr_scheduler"], [3, 1, 1, "", "train_step"]], "torchtnt.framework": [[4, 2, 0, "-", "callback"]], "torchtnt.framework.callback": [[4, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[4, 3, 1, "", "name"], [4, 1, 1, "", "on_eval_end"], [4, 1, 1, "", "on_eval_epoch_end"], [4, 1, 1, "", "on_eval_epoch_start"], [4, 1, 1, "", "on_eval_get_next_batch_end"], [4, 1, 1, "", "on_eval_start"], [4, 1, 1, "", "on_eval_step_end"], [4, 1, 1, "", "on_eval_step_start"], [4, 1, 1, "", "on_exception"], [4, 1, 1, "", "on_predict_end"], [4, 1, 1, "", "on_predict_epoch_end"], [4, 1, 1, "", "on_predict_epoch_start"], [4, 1, 1, "", "on_predict_get_next_batch_end"], [4, 1, 1, "", "on_predict_start"], [4, 1, 1, "", "on_predict_step_end"], [4, 1, 1, "", "on_predict_step_start"], [4, 1, 1, "", "on_train_end"], [4, 1, 1, "", "on_train_epoch_end"], [4, 1, 1, "", "on_train_epoch_start"], [4, 1, 1, "", "on_train_get_next_batch_end"], [4, 1, 1, "", "on_train_start"], [4, 1, 1, "", "on_train_step_end"], [4, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[7, 0, 1, "", "BaseCSVWriter"], [8, 0, 1, "", "EarlyStopping"], [9, 0, 1, "", "GarbageCollector"], [10, 0, 1, "", "IterationTimeLogger"], [11, 0, 1, "", "Lambda"], [12, 0, 1, "", "LearningRateMonitor"], [13, 0, 1, "", "MemorySnapshot"], [14, 0, 1, "", "ModuleSummary"], [15, 0, 1, "", "ProgressReporter"], [16, 0, 1, "", "PyTorchProfiler"], [17, 0, 1, "", "SlowRankDetector"], [18, 0, 1, "", "SystemResourcesMonitor"], [19, 0, 1, "", "TQDMProgressBar"], [20, 0, 1, "", "TensorBoardParameterMonitor"], [21, 0, 1, "", "ThroughputLogger"], [22, 0, 1, "", "TimeLimitInterrupter"], [23, 0, 1, "", "TimeWaitForBatchLogger"], [24, 0, 1, "", "TorchSnapshotSaver"], [25, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[7, 1, 1, "", "on_exception"], [7, 1, 1, "", "on_predict_end"], [7, 1, 1, "", "on_predict_start"], [7, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.EarlyStopping": [[8, 1, 1, "", "on_train_epoch_end"], [8, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[9, 1, 1, "", "on_eval_end"], [9, 1, 1, "", "on_eval_start"], [9, 1, 1, "", "on_eval_step_end"], [9, 1, 1, "", "on_predict_end"], [9, 1, 1, "", "on_predict_start"], [9, 1, 1, "", "on_predict_step_end"], [9, 1, 1, "", "on_train_end"], [9, 1, 1, "", "on_train_start"], [9, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.IterationTimeLogger": [[10, 1, 1, "", "on_eval_end"], [10, 1, 1, "", "on_eval_step_end"], [10, 1, 1, "", "on_predict_end"], [10, 1, 1, "", "on_predict_step_end"], [10, 1, 1, "", "on_train_end"], [10, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[12, 1, 1, "", "on_train_epoch_start"], [12, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.MemorySnapshot": [[13, 1, 1, "", "on_eval_step_end"], [13, 1, 1, "", "on_predict_step_end"], [13, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.ModuleSummary": [[14, 1, 1, "", "on_eval_start"], [14, 1, 1, "", "on_predict_start"], [14, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.ProgressReporter": [[15, 1, 1, "", "on_eval_end"], [15, 1, 1, "", "on_eval_epoch_end"], [15, 1, 1, "", "on_eval_epoch_start"], [15, 1, 1, "", "on_eval_start"], [15, 1, 1, "", "on_eval_step_end"], [15, 1, 1, "", "on_eval_step_start"], [15, 1, 1, "", "on_predict_end"], [15, 1, 1, "", "on_predict_epoch_end"], [15, 1, 1, "", "on_predict_epoch_start"], [15, 1, 1, "", "on_predict_start"], [15, 1, 1, "", "on_predict_step_end"], [15, 1, 1, "", "on_predict_step_start"], [15, 1, 1, "", "on_train_end"], [15, 1, 1, "", "on_train_epoch_end"], [15, 1, 1, "", "on_train_epoch_start"], [15, 1, 1, "", "on_train_start"], [15, 1, 1, "", "on_train_step_end"], [15, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[16, 1, 1, "", "on_eval_end"], [16, 1, 1, "", "on_eval_start"], [16, 1, 1, "", "on_eval_step_end"], [16, 1, 1, "", "on_predict_end"], [16, 1, 1, "", "on_predict_start"], [16, 1, 1, "", "on_predict_step_end"], [16, 1, 1, "", "on_train_end"], [16, 1, 1, "", "on_train_start"], [16, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SlowRankDetector": [[17, 1, 1, "", "on_train_epoch_end"], [17, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[18, 1, 1, "", "on_eval_epoch_start"], [18, 1, 1, "", "on_eval_step_start"], [18, 1, 1, "", "on_predict_epoch_start"], [18, 1, 1, "", "on_predict_step_start"], [18, 1, 1, "", "on_train_epoch_start"], [18, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[19, 1, 1, "", "on_eval_epoch_end"], [19, 1, 1, "", "on_eval_epoch_start"], [19, 1, 1, "", "on_eval_step_end"], [19, 1, 1, "", "on_predict_epoch_end"], [19, 1, 1, "", "on_predict_epoch_start"], [19, 1, 1, "", "on_predict_step_end"], [19, 1, 1, "", "on_train_epoch_end"], [19, 1, 1, "", "on_train_epoch_start"], [19, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[20, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.ThroughputLogger": [[21, 1, 1, "", "on_eval_end"], [21, 1, 1, "", "on_eval_start"], [21, 1, 1, "", "on_eval_step_end"], [21, 1, 1, "", "on_predict_end"], [21, 1, 1, "", "on_predict_start"], [21, 1, 1, "", "on_predict_step_end"], [21, 1, 1, "", "on_train_end"], [21, 1, 1, "", "on_train_epoch_end"], [21, 1, 1, "", "on_train_epoch_start"], [21, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TimeLimitInterrupter": [[22, 1, 1, "", "on_train_epoch_end"], [22, 1, 1, "", "on_train_start"], [22, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TimeWaitForBatchLogger": [[23, 1, 1, "", "on_eval_step_end"], [23, 1, 1, "", "on_predict_step_end"], [23, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[24, 1, 1, "", "on_exception"], [24, 1, 1, "", "on_train_start"], [24, 1, 1, "", "restore"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[25, 1, 1, "", "on_train_epoch_end"], [25, 1, 1, "", "on_train_start"]], "torchtnt.framework.evaluate": [[5, 4, 1, "", "evaluate"]], "torchtnt.framework.fit": [[6, 4, 1, "", "fit"]], "torchtnt.framework.predict": [[26, 4, 1, "", "predict"]], "torchtnt.framework.state": [[27, 0, 1, "", "PhaseState"], [27, 0, 1, "", "State"]], "torchtnt.framework.state.PhaseState": [[27, 3, 1, "", "dataloader"], [27, 3, 1, "", "evaluate_every_n_epochs"], [27, 3, 1, "", "evaluate_every_n_steps"], [27, 3, 1, "", "iteration_timer"], [27, 3, 1, "", "max_epochs"], [27, 3, 1, "", "max_steps"], [27, 3, 1, "", "max_steps_per_epoch"], [27, 3, 1, "", "step_output"]], "torchtnt.framework.state.State": [[27, 3, 1, "", "active_phase"], [27, 1, 1, "", "active_phase_state"], [27, 3, 1, "", "entry_point"], [27, 3, 1, "", "eval_state"], [27, 3, 1, "", "predict_state"], [27, 3, 1, "", "should_stop"], [27, 1, 1, "", "stop"], [27, 3, 1, "", "timer"], [27, 3, 1, "", "train_state"]], "torchtnt.framework.train": [[28, 4, 1, "", "train"]], "torchtnt.framework.unit": [[29, 0, 1, "", "EvalUnit"], [29, 0, 1, "", "PredictUnit"], [29, 0, 1, "", "TrainUnit"]], "torchtnt.framework.unit.EvalUnit": [[29, 1, 1, "", "eval_step"], [29, 1, 1, "", "get_next_eval_batch"], [29, 1, 1, "", "on_eval_end"], [29, 1, 1, "", "on_eval_epoch_end"], [29, 1, 1, "", "on_eval_epoch_start"], [29, 1, 1, "", "on_eval_start"]], "torchtnt.framework.unit.PredictUnit": [[29, 1, 1, "", "get_next_predict_batch"], [29, 1, 1, "", "on_predict_end"], [29, 1, 1, "", "on_predict_epoch_end"], [29, 1, 1, "", "on_predict_epoch_start"], [29, 1, 1, "", "on_predict_start"], [29, 1, 1, "", "predict_step"]], "torchtnt.framework.unit.TrainUnit": [[29, 1, 1, "", "get_next_train_batch"], [29, 1, 1, "", "on_train_end"], [29, 1, 1, "", "on_train_epoch_end"], [29, 1, 1, "", "on_train_epoch_start"], [29, 1, 1, "", "on_train_start"], [29, 1, 1, "", "train_step"]], "torchtnt.utils.data": [[32, 0, 1, "", "AbstractRandomDataset"], [33, 0, 1, "", "AllDatasetBatchesIterator"], [34, 0, 1, "", "CudaDataPrefetcher"], [35, 0, 1, "", "InOrderIterator"], [36, 0, 1, "", "MultiDataLoader"], [37, 0, 1, "", "MultiIterator"], [38, 0, 1, "", "RandomizedBatchSamplerIterator"], [39, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.AbstractRandomDataset": [[32, 1, 1, "", "__init__"], [32, 5, 1, "", "size"]], "torchtnt.utils.data.AllDatasetBatchesIterator": [[33, 1, 1, "", "__init__"]], "torchtnt.utils.data.CudaDataPrefetcher": [[34, 1, 1, "", "__init__"]], "torchtnt.utils.data.InOrderIterator": [[35, 1, 1, "", "__init__"]], "torchtnt.utils.data.MultiDataLoader": [[36, 1, 1, "", "__init__"], [36, 5, 1, "", "ignore_empty_data"], [36, 5, 1, "", "individual_dataloaders"], [36, 5, 1, "", "iteration_strategy"], [36, 5, 1, "", "iterator_cls"]], "torchtnt.utils.data.MultiIterator": [[37, 1, 1, "", "__init__"]], "torchtnt.utils.data.RandomizedBatchSamplerIterator": [[38, 1, 1, "", "__init__"]], "torchtnt.utils.data.RoundRobinIterator": [[39, 1, 1, "", "__init__"]], "torchtnt.utils.device": [[40, 4, 1, "", "copy_data_to_device"], [41, 4, 1, "", "get_device_from_env"], [42, 4, 1, "", "get_nvidia_smi_gpu_stats"], [43, 4, 1, "", "get_psutil_cpu_stats"], [44, 4, 1, "", "record_data_in_stream"], [45, 4, 1, "", "set_float32_precision"]], "torchtnt.utils.distributed": [[46, 0, 1, "", "PGWrapper"], [47, 4, 1, "", "all_gather_tensors"], [48, 4, 1, "", "barrier"], [49, 4, 1, "", "destroy_process_group"], [50, 4, 1, "", "get_file_init_method"], [51, 4, 1, "", "get_global_rank"], [52, 4, 1, "", "get_local_rank"], [53, 4, 1, "", "get_process_group_backend_from_device"], [54, 4, 1, "", "get_tcp_init_method"], [55, 4, 1, "", "get_world_size"], [56, 4, 1, "", "rank_zero_fn"], [57, 4, 1, "", "revert_sync_batchnorm"], [58, 4, 1, "", "spawn_multi_process"], [59, 4, 1, "", "sync_bool"]], "torchtnt.utils.distributed.PGWrapper": [[46, 1, 1, "", "__init__"]], "torchtnt.utils.early_stop_checker": [[60, 0, 1, "", "EarlyStopChecker"]], "torchtnt.utils.early_stop_checker.EarlyStopChecker": [[60, 1, 1, "", "__init__"]], "torchtnt.utils.env": [[61, 4, 1, "", "init_from_env"], [62, 4, 1, "", "seed"]], "torchtnt.utils.flops": [[63, 0, 1, "", "FlopTensorDispatchMode"]], "torchtnt.utils.flops.FlopTensorDispatchMode": [[63, 1, 1, "", "__init__"]], "torchtnt.utils.fsspec": [[64, 4, 1, "", "get_filesystem"]], "torchtnt.utils.loggers": [[65, 0, 1, "", "CSVLogger"], [66, 0, 1, "", "FileLogger"], [67, 0, 1, "", "InMemoryLogger"], [68, 0, 1, "", "JSONLogger"], [69, 0, 1, "", "MetricLogger"], [70, 0, 1, "", "StdoutLogger"], [71, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[65, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.FileLogger": [[66, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.InMemoryLogger": [[67, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.JSONLogger": [[68, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.MetricLogger": [[69, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.StdoutLogger": [[70, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.TensorBoardLogger": [[71, 1, 1, "", "__init__"]], "torchtnt.utils.memory": [[72, 0, 1, "", "RSSProfiler"], [73, 4, 1, "", "measure_rss_deltas"]], "torchtnt.utils.memory.RSSProfiler": [[72, 1, 1, "", "__init__"], [72, 5, 1, "", "interval"], [72, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.memory_snapshot_profiler": [[74, 0, 1, "", "MemorySnapshotProfiler"]], "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler": [[74, 1, 1, "", "__init__"]], "torchtnt.utils.misc": [[75, 4, 1, "", "days_to_secs"], [76, 4, 1, "", "transfer_batch_norm_stats"]], "torchtnt.utils.module_summary": [[77, 0, 1, "", "ModuleSummary"], [78, 4, 1, "", "get_module_summary"], [79, 4, 1, "", "get_summary_table"], [80, 4, 1, "", "prune_module_summary"]], "torchtnt.utils.module_summary.ModuleSummary": [[77, 1, 1, "", "__init__"]], "torchtnt.utils.oom": [[81, 4, 1, "", "attach_oom_observer"], [82, 4, 1, "", "is_out_of_cpu_memory"], [83, 4, 1, "", "is_out_of_cuda_memory"], [84, 4, 1, "", "is_out_of_memory_error"], [85, 4, 1, "", "log_memory_snapshot"]], "torchtnt.utils.optimizer": [[86, 4, 1, "", "init_optim_state"]], "torchtnt.utils.precision": [[87, 4, 1, "", "convert_precision_str_to_dtype"]], "torchtnt.utils.prepare_module": [[88, 0, 1, "", "DDPStrategy"], [89, 0, 1, "", "FSDPStrategy"], [90, 4, 1, "", "convert_str_to_strategy"], [91, 4, 1, "", "prepare_ddp"], [92, 4, 1, "", "prepare_fsdp"], [93, 4, 1, "", "prepare_module"]], "torchtnt.utils.prepare_module.DDPStrategy": [[88, 1, 1, "", "__init__"]], "torchtnt.utils.prepare_module.FSDPStrategy": [[89, 1, 1, "", "__init__"]], "torchtnt.utils.progress": [[94, 0, 1, "", "Progress"], [95, 4, 1, "", "estimated_steps_in_epoch"], [96, 4, 1, "", "estimated_steps_in_fit"], [97, 4, 1, "", "estimated_steps_in_loop"]], "torchtnt.utils.progress.Progress": [[94, 1, 1, "", "__init__"]], "torchtnt.utils.rank_zero_log": [[98, 4, 1, "", "rank_zero_critical"], [99, 4, 1, "", "rank_zero_debug"], [100, 4, 1, "", "rank_zero_error"], [101, 4, 1, "", "rank_zero_info"], [102, 4, 1, "", "rank_zero_print"], [103, 4, 1, "", "rank_zero_warn"]], "torchtnt.utils.stateful": [[104, 0, 1, "", "MultiStateful"], [105, 0, 1, "", "Stateful"]], "torchtnt.utils.stateful.MultiStateful": [[104, 1, 1, "", "__init__"]], "torchtnt.utils.stateful.Stateful": [[105, 1, 1, "", "__init__"]], "torchtnt.utils.swa": [[106, 0, 1, "", "AveragedModel"]], "torchtnt.utils.swa.AveragedModel": [[106, 1, 1, "", "__init__"]], "torchtnt.utils.test_utils": [[107, 4, 1, "", "get_pet_launch_config"], [108, 4, 1, "", "is_asan"], [109, 4, 1, "", "is_tsan"], [110, 4, 1, "", "skip_if_asan"]], "torchtnt.utils.timer": [[111, 0, 1, "", "BoundedTimer"], [112, 0, 1, "", "FullSyncPeriodicTimer"], [113, 0, 1, "", "Timer"], [114, 0, 1, "", "TimerProtocol"], [115, 4, 1, "", "get_durations_histogram"], [116, 4, 1, "", "get_recorded_durations_table"], [117, 4, 1, "", "get_synced_durations_histogram"], [118, 4, 1, "", "get_synced_timer_histogram"], [119, 4, 1, "", "get_timer_summary"], [120, 4, 1, "", "log_elapsed_time"]], "torchtnt.utils.timer.BoundedTimer": [[111, 1, 1, "", "__init__"]], "torchtnt.utils.timer.FullSyncPeriodicTimer": [[112, 1, 1, "", "__init__"]], "torchtnt.utils.timer.Timer": [[113, 1, 1, "", "__init__"]], "torchtnt.utils.timer.TimerProtocol": [[114, 1, 1, "", "__init__"]], "torchtnt.utils.tqdm": [[121, 4, 1, "", "close_progress_bar"], [122, 4, 1, "", "create_progress_bar"], [123, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.version": [[124, 4, 1, "", "get_python_version"], [125, 4, 1, "", "get_torch_version"], [126, 4, 1, "", "is_windows"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"checkpoint": 0, "fulli": [0, 1], "shard": [0, 1], "data": [0, 1, 32, 33, 34, 35, 36, 37, 38, 39, 127], "parallel": [0, 1], "finetun": 0, "best": 0, "model": [0, 31], "metric": 0, "distribut": [1, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 127], "train": [1, 2, 28, 31], "exampl": [2, 30], "trainunit": [2, 29], "autounit": [2, 3], "torchdata": 2, "mnist": 2, "mingpt": 2, "torchrec": 2, "callback": [4, 31], "built": 4, "evalu": 5, "entri": [5, 6, 26, 28], "point": [5, 6, 26, 28], "fit": 6, "basecsvwrit": 7, "earlystop": 8, "garbagecollector": 9, "iterationtimelogg": 10, "lambda": 11, "learningratemonitor": 12, "memorysnapshot": 13, "modulesummari": [14, 77], "progressreport": 15, "pytorchprofil": 16, "slowrankdetector": 17, "systemresourcesmonitor": 18, "tqdmprogressbar": 19, "tensorboardparametermonitor": 20, "throughputlogg": 21, "timelimitinterrupt": 22, "timewaitforbatchlogg": 23, "torchsnapshotsav": 24, "trainprogressmonitor": 25, "predict": 26, "state": [27, 104, 105, 127], "phasest": 27, "unit": 29, "evalunit": 29, "predictunit": 29, "combin": 29, "multipl": 29, "welcom": 30, "torchtnt": [30, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126], "document": 30, "instal": 30, "overview": [30, 31], "core": [30, 31], "concept": 30, "framework": [30, 31], "util": [30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127], "function": 31, "api": 31, "organ": 31, "your": 31, "code": 31, "abstractrandomdataset": 32, "alldatasetbatchesiter": 33, "cudadataprefetch": 34, "inorderiter": 35, "multidataload": 36, "multiiter": 37, "randomizedbatchsampleriter": 38, "roundrobiniter": 39, "devic": [40, 41, 42, 43, 44, 45, 127], "copy_data_to_devic": 40, "get_device_from_env": 41, "get_nvidia_smi_gpu_stat": 42, "get_psutil_cpu_stat": 43, "record_data_in_stream": 44, "set_float32_precis": 45, "pgwrapper": 46, "all_gather_tensor": 47, "barrier": 48, "destroy_process_group": 49, "get_file_init_method": 50, "get_global_rank": 51, "get_local_rank": 52, "get_process_group_backend_from_devic": 53, "get_tcp_init_method": 54, "get_world_s": 55, "rank_zero_fn": 56, "revert_sync_batchnorm": 57, "spawn_multi_process": 58, "sync_bool": 59, "early_stop_check": 60, "earlystopcheck": 60, "env": [61, 62], "init_from_env": 61, "seed": 62, "flop": [63, 127], "floptensordispatchmod": 63, "fsspec": 64, "get_filesystem": 64, "logger": [65, 66, 67, 68, 69, 70, 71, 127], "csvlogger": 65, "filelogg": 66, "inmemorylogg": 67, "jsonlogg": 68, "metriclogg": 69, "stdoutlogg": 70, "tensorboardlogg": 71, "memori": [72, 73, 127], "rssprofil": 72, "measure_rss_delta": 73, "memory_snapshot_profil": 74, "memorysnapshotprofil": [74, 127], "misc": [75, 76, 127], "days_to_sec": 75, "transfer_batch_norm_stat": 76, "module_summari": [77, 78, 79, 80], "get_module_summari": 78, "get_summary_t": 79, "prune_module_summari": 80, "oom": [81, 82, 83, 84, 85, 127], "attach_oom_observ": 81, "is_out_of_cpu_memori": 82, "is_out_of_cuda_memori": 83, "is_out_of_memory_error": 84, "log_memory_snapshot": 85, "optim": [86, 127], "init_optim_st": 86, "precis": [87, 127], "convert_precision_str_to_dtyp": 87, "prepare_modul": [88, 89, 90, 91, 92, 93], "ddpstrategi": 88, "fsdpstrategi": 89, "convert_str_to_strategi": 90, "prepare_ddp": 91, "prepare_fsdp": 92, "progress": [94, 95, 96, 97, 127], "estimated_steps_in_epoch": 95, "estimated_steps_in_fit": 96, "estimated_steps_in_loop": 97, "rank_zero_log": [98, 99, 100, 101, 102, 103], "rank_zero_crit": 98, "rank_zero_debug": 99, "rank_zero_error": 100, "rank_zero_info": 101, "rank_zero_print": 102, "rank_zero_warn": 103, "multist": 104, "swa": [106, 127], "averagedmodel": 106, "test_util": [107, 108, 109, 110], "get_pet_launch_config": 107, "is_asan": 108, "is_tsan": 109, "skip_if_asan": 110, "timer": [111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 127], "boundedtim": 111, "fullsyncperiodictim": 112, "timerprotocol": 114, "get_durations_histogram": 115, "get_recorded_durations_t": 116, "get_synced_durations_histogram": 117, "get_synced_timer_histogram": 118, "get_timer_summari": 119, "log_elapsed_tim": 120, "tqdm": [121, 122, 123, 127], "close_progress_bar": 121, "create_progress_bar": 122, "update_progress_bar": 123, "version": [124, 125, 126, 127], "get_python_vers": 124, "get_torch_vers": 125, "is_window": 126, "earli": 127, "stop": 127, "checker": 127, "environ": 127, "filesystem": 127, "spec": 127, "modul": 127, "summari": 127, "prepar": 127, "rank": 127, "zero": 127, "log": 127, "test": 127}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})